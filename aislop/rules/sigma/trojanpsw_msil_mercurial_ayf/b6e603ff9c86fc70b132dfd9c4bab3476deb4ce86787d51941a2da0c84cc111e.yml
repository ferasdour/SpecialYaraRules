title: TrojanPSW.MSIL.Mercurial.ayf behavior detection (b6e603ff)
id: b6e603ff9c86fc70b132dfd9c4bab3476deb4ce86787d51941a2da0c84cc111e
status: experimental
description: Auto-generated Sigma rule for TrojanPSW.MSIL.Mercurial.ayf
logsource:
  product: windows
  service: sysmon
detection:
  selection_behavior:
  - EventData: 'Found reference to API "RegCloseKey" (Indicator: "RegCloseKey"; File:
      "Wii.exe")'
  - EventData: Contains ability to disable/close registry key (API string)
  - EventData: string-345
  - EventData: 'Found reference to API "ShellExecuteExW" (Indicator: "ShellExecute";
      File: "Wii.exe")'
  - EventData: Contains ability to execute an application (API string)
  - EventData: string-240
  - EventData: 'Found reference to API "CreateFileW" (Indicator: "CreateFile"; File:
      "Wii.exe")'
  - EventData: Contains ability to create/open files (API string)
  - EventData: string-315
  - EventData: 'Found reference to API "CreateDirectoryW" (Indicator: "CreateDirectory";
      File: "Wii.exe")'
  - EventData: Contains ability to create directories (API string)
  - EventData: string-423
  - EventData: "\"Software\\Microsoft\\Windows\\CurrentVersion\" in Source: Wii.exe\n\
      \ \"Software\\WinRAR SFX\" in Source: Wii.exe"
  - EventData: Contains registry location strings
  - EventData: string-120
  - EventData: "\"Wii.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcryptprimitives.dll\"\
      \ at 75AA0000\n \"Wii.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcrypt.dll\"\
      \ at 73810000"
  - EventData: Loads the Bcrypt module DLL
  - EventData: module-9
  - EventData: "Process Wii.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\\
      SM0:716:168:WilStaging_02\"\n Process Wii.exe created mutex with name  \"\\\
      Sessions\\1\\BaseNamedObjects\\Local\\SM0:716:168:WilStaging_02\"\n Process\
      \ Wii.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\SM0:716:64:WilError_01\"\
      \n Process Wii.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\\
      Local\\ZonesCacheCounterMutex\"\n Process Wii.exe created mutex with name  \"\
      \\Sessions\\1\\BaseNamedObjects\\Local\\ZonesLockedCacheCounterMutex\"\n Process\
      \ Wii.exe created mutex with name  \"SM0:716:64:WilError_01\"\n Process Wii.exe\
      \ created mutex with name  \"Local\\SM0:716:168:WilStaging_02\"\n Process Wii.exe\
      \ created mutex with name  \"Local\\ZonesCacheCounterMutex\"\n Process Wii.exe\
      \ created mutex with name  \"SM0:716:168:WilStaging_02\"\n Process Wii.exe created\
      \ mutex with name  \"Local\\ZonesLockedCacheCounterMutex\""
  - EventData: Creates mutants
  - EventData: mutant-0
  - EventData: "\"Wii.exe\" touched \"Microsoft Multiple AutoComplete List Container\"\
      \ (Path: \"HKCU\\WOW6432NODE\\CLSID\\{00BB2765-6A77-11D0-A535-00C04FD7D062}\"\
      )\n \"Wii.exe\" touched \"Microsoft Shell Folder AutoComplete List\" (Path:\
      \ \"HKCU\\WOW6432NODE\\CLSID\\{03C036F1-A186-11D0-824A-00AA005B4383}\\TREATAS\"\
      )\n \"Wii.exe\" touched \"Microsoft AutoComplete\" (Path: \"HKCU\\WOW6432NODE\\\
      CLSID\\{00BB2763-6A77-11D0-A535-00C04FD7D062}\\TREATAS\")\n \"Wii.exe\" touched\
      \ \"Microsoft TipAutoCompleteClient Control\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\\
      {807C1E6C-1D00-453F-B920-B61BB7CDD997}\\TREATAS\")\n \"Wii.exe\" touched \"\
      Microsoft Web Browser\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{8856F961-340A-11D0-A96B-00C04FD705A2}\\\
      TREATAS\")\n \"Wii.exe\" touched \"Microsoft HTML About Pluggable Protocol\"\
      \ (Path: \"HKCU\\WOW6432NODE\\CLSID\\{3050F406-98B5-11CF-BB82-00AA00BDCE0B}\\\
      TREATAS\")\n \"Wii.exe\" touched \"HTML Document\" (Path: \"HKCU\\WOW6432NODE\\\
      CLSID\\{25336920-03F9-11CF-8FD0-00AA00686F13}\\TREATAS\")\n \"Wii.exe\" touched\
      \ \"CActiveIMMAppEx_Trident\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{50D5107A-D278-4871-8989-F4CEAAF59CFC}\\\
      TREATAS\")\n \"Wii.exe\" touched \"Microsoft Url History Service\" (Path: \"\
      HKCU\\WOW6432NODE\\CLSID\\{3C374A40-BAE4-11CF-BF7D-00AA006946EE}\\TREATAS\"\
      )\n \"Wii.exe\" touched \"UIAutomation Registrar Class\" (Path: \"HKCU\\WOW6432NODE\\\
      CLSID\\{6E29FABF-9977-42D1-8D0E-CA7E61AD87E6}\\TREATAS\")"
  - EventData: Overview of unique CLSIDs touched in registry
  - EventData: registry-72
  - EventData: "\"Wii.exe\" has flags like  IMAGE_FILE_32BIT_MACHINE\n IMAGE_FILE_EXECUTABLE"
  - EventData: Uses 32 bit executable PE
  - EventData: static-153
  - EventData: '"SELECT * FROM Win32_OperatingSystem" (Source: Wii.exe, Indicator:
      "select * from win32_operatingsystem")'
  - EventData: Contains SQL queries
  - EventData: string-16
  - EventData: '"D:\Projects\WinRAR\SFX\build\sfxrar32\Release\sfxrar.pdb"'
  - EventData: Contains PDB pathways
  - EventData: string-7
  - EventData: "Found reference to API (Indicator: \"CryptProtectMemory\"; File: \"\
      Wii.exe\")\n Found reference to API (Indicator: \"CryptUnprotectMemory\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"SetDllDirectoryW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"SetDefaultDllDirectories\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"AcquireSRWLockExclusive\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"ReleaseSRWLockExclusive\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"FlsAlloc\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"FlsFree\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"FlsGetValue\"; File: \"Wii.exe\")\n\
      \ Found reference to API (Indicator: \"FlsSetValue\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"InitializeCriticalSectionEx\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"AreFileApisANSI\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"LCMapStringEx\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"LocaleNameToLCID\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"ShowWindow\"; File: \"Wii.exe\")\n\
      \ Found reference to API (Indicator: \"EnableWindow\"; File: \"Wii.exe\")\n\
      \ Found reference to API (Indicator: \"SetWindowTextW\"; File: \"Wii.exe\")\n\
      \ Found reference to API (Indicator: \"GetWindowTextW\"; File: \"Wii.exe\")\n\
      \ Found reference to API (Indicator: \"GetWindowTextLengthW\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"GetParent\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"SetWindowPos\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"GetSystemMetrics\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"GetClientRect\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"GetWindowRect\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"GetWindow\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"LoadStringW\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"CharUpperW\"; File: \"Wii.exe\")\n Found reference to API\
      \ (Indicator: \"DefWindowProcW\"; File: \"Wii.exe\")\n Found reference to API\
      \ (Indicator: \"CreateWindowExW\"; File: \"Wii.exe\")\n Found reference to API\
      \ (Indicator: \"IsWindow\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"DestroyWindow\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"MoveWindow\"; File: \"Wii.exe\")\n Found reference to API (Indicator: \"\
      UpdateWindow\"; File: \"Wii.exe\")\n Found reference to API (Indicator: \"MapWindowPoints\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"CopyRect\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"LoadCursorW\"; File: \"\
      Wii.exe\")\n Found reference to API (Indicator: \"GetDC\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"ReleaseDC\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"MessageBoxW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"CopyImage\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"SetUserObjectInformationW\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"TranslateMessage\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"DispatchMessageW\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"PeekMessageW\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"IsWindowVisible\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"SetFocus\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"SetForegroundWindow\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetSysColor\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"LoadIconW\"; File: \"Wii.exe\")\n Found reference to API\
      \ (Indicator: \"DestroyIcon\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"CreateCompatibleBitmap\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"CreateCompatibleDC\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"DeleteDC\"; File: \"Wii.exe\")\n Found reference to API (Indicator: \"DeleteObject\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"GetDeviceCaps\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"SelectObject\";\
      \ File: \"Wii.exe\")\n Found reference to API (Indicator: \"StretchBlt\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"GetObjectW\"; File: \"\
      Wii.exe\")\n Found reference to API (Indicator: \"GetOpenFileNameW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"GetSaveFileNameW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"SetFileSecurityW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"OpenProcessToken\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"AdjustTokenPrivileges\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"AllocateAndInitializeSid\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"CheckTokenMembership\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"FreeSid\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"LookupPrivilegeValueW\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"CopySid\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"GetTokenInformation\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"InitializeSecurityDescriptor\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"SetSecurityDescriptorDacl\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"RegCloseKey\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"RegCreateKeyExW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"RegOpenKeyExW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"RegQueryValueExW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"RegSetValueExW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"SetEntriesInAclW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"SHGetMalloc\"; File: \"\
      Wii.exe\")\n Found reference to API (Indicator: \"SHBrowseForFolderW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"SHGetPathFromIDListW\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"SHFileOperationW\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"ShellExecuteExW\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"SHGetFileInfoW\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"SHGetFolderPathW\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"CoCreateInstance\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"CreateStreamOnHGlobal\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"CLSIDFromString\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"OleInitialize\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"OleUninitialize\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"CreateFileW\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"ReadFile\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"WriteFile\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"CloseHandle\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetLastError\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"ConnectNamedPipe\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"DisconnectNamedPipe\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"PeekNamedPipe\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"CreateNamedPipeW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"WaitNamedPipeW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetOverlappedResult\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"WaitForSingleObject\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"CreateEventW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"SetLastError\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"LocalFree\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"FormatMessageW\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"DeleteFileW\"; File: \"Wii.exe\")\n Found reference to API\
      \ (Indicator: \"RemoveDirectoryW\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"SetFileTime\"; File: \"Wii.exe\")\n Found reference to API\
      \ (Indicator: \"DeviceIoControl\"; File: \"Wii.exe\")\n Found reference to API\
      \ (Indicator: \"CreateHardLinkW\"; File: \"Wii.exe\")\n Found reference to API\
      \ (Indicator: \"GetLongPathNameW\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"GetShortPathNameW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"MoveFileW\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"GetStdHandle\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"FlushFileBuffers\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetFileType\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"SetEndOfFile\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"SetFilePointer\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"CreateDirectoryW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetFileAttributesW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"SetFileAttributesW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetCurrentProcessId\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"FindClose\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"FindFirstFileW\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"FindNextFileW\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"GetVersionExW\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"SetCurrentDirectoryW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetCurrentDirectoryW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetFullPathNameW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetModuleFileNameW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"FoldStringW\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"GetModuleHandleW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"FindResourceW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"FreeLibrary\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"GetProcAddress\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"ExpandEnvironmentStringsW\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"Sleep\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetCurrentProcess\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"ExitProcess\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"GetSystemDirectoryW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"LoadLibraryW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"SetThreadExecutionState\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"CompareStringW\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"AllocConsole\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"FreeConsole\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"AttachConsole\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"WriteConsoleW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"InitializeCriticalSection\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"EnterCriticalSection\"; File: \"Wii.exe\")\n\
      \ Found reference to API (Indicator: \"LeaveCriticalSection\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"DeleteCriticalSection\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"SetEvent\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"ResetEvent\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"ReleaseSemaphore\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"CreateSemaphoreW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"CreateThread\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"SetThreadPriority\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetProcessAffinityMask\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"GetSystemTime\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"SystemTimeToTzSpecificLocalTime\"; File: \"\
      Wii.exe\")\n Found reference to API (Indicator: \"FileTimeToSystemTime\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"SystemTimeToFileTime\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"MultiByteToWideChar\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"WideCharToMultiByte\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"GetCPInfo\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"IsDBCSLeadByte\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"GlobalAlloc\"; File: \"\
      Wii.exe\")\n Found reference to API (Indicator: \"GlobalMemoryStatusEx\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"LoadResource\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"LockResource\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"SizeofResource\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"GlobalUnlock\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"GlobalLock\"; File: \"\
      Wii.exe\")\n Found reference to API (Indicator: \"GlobalFree\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"GetDateFormatW\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"GetTimeFormatW\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"GetCommandLineW\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"SetEnvironmentVariableW\"; File: \"\
      Wii.exe\")\n Found reference to API (Indicator: \"GetTempPathW\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"GetExitCodeProcess\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"GetLocalTime\"; File: \"Wii.exe\")\n\
      \ Found reference to API (Indicator: \"GetTickCount\"; File: \"Wii.exe\")\n\
      \ Found reference to API (Indicator: \"MoveFileExW\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"GetLocaleInfoW\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"GetNumberFormatW\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"RaiseException\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"GetSystemInfo\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"VirtualProtect\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"VirtualQuery\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"LoadLibraryExA\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"UnhandledExceptionFilter\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"SetUnhandledExceptionFilter\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"TerminateProcess\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"IsProcessorFeaturePresent\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"WakeAllConditionVariable\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"SleepConditionVariableSRW\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"IsDebuggerPresent\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"GetStartupInfoW\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"QueryPerformanceCounter\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"GetCurrentThreadId\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"GetSystemTimeAsFileTime\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"InitializeSListHead\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"RtlUnwind\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"EncodePointer\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"InitializeCriticalSectionAndSpinCount\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"TlsAlloc\"; File:\
      \ \"Wii.exe\")\n Found reference to API (Indicator: \"TlsGetValue\"; File: \"\
      Wii.exe\")\n Found reference to API (Indicator: \"TlsSetValue\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"TlsFree\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"LoadLibraryExW\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"QueryPerformanceFrequency\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"GetModuleHandleExW\"; File: \"Wii.exe\"\
      )\n Found reference to API (Indicator: \"HeapFree\"; File: \"Wii.exe\")\n Found\
      \ reference to API (Indicator: \"HeapAlloc\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"HeapReAlloc\"; File: \"Wii.exe\")\n Found reference to\
      \ API (Indicator: \"FindFirstFileExW\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"IsValidCodePage\"; File: \"Wii.exe\")\n Found reference\
      \ to API (Indicator: \"GetACP\"; File: \"Wii.exe\")\n Found reference to API\
      \ (Indicator: \"GetOEMCP\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"GetCommandLineA\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"GetEnvironmentStringsW\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"FreeEnvironmentStringsW\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"LCMapStringW\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"GetProcessHeap\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"SetStdHandle\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"GetStringTypeW\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"SetFilePointerEx\"; File: \"Wii.exe\")\n Found reference to API (Indicator:\
      \ \"HeapSize\"; File: \"Wii.exe\")\n Found reference to API (Indicator: \"GetConsoleOutputCP\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"GetConsoleMode\"\
      ; File: \"Wii.exe\")\n Found reference to API (Indicator: \"DecodePointer\"\
      ; File: \"Wii.exe\")"
  - EventData: Contains ability to execute Windows APIs
  - EventData: string-101
  - EventData: 'Found reference to API "ShowWindow" (Indicator: "ShowWindow"; File:
      "Wii.exe")'
  - EventData: Contains ability to show a graphical window (API string)
  - EventData: string-208
  - EventData: 'Found registry modification API: "RegCreateKeyExW" in file "Wii.exe"'
  - EventData: Able to create/load registry keys (API string)
  - EventData: string-307
  - EventData: "Found reference to API \"OpenProcessToken\" (Indicator: \"OpenProcess\"\
      ; File: \"Wii.exe\")\n Found reference to API \"GetProcessHeap\" (Indicator:\
      \ \"GetProcessHeap\"; File: \"Wii.exe\")"
  - EventData: Contains ability to retrieve/open a process (API string)
  - EventData: string-272
  - EventData: "Found reference to API \"GetLastError\" (Indicator: \"GetLastError\"\
      ; File: \"Wii.exe\")\n Found reference to API \"SetLastError\" (Indicator: \"\
      SetLastError\"; File: \"Wii.exe\")\n Found reference to API \"WaitForMultipleObjects\
      \ error %d, GetLastError %d\" (Indicator: \"GetLastError\"; File: \"Wii.exe\"\
      )"
  - EventData: Contains ability to set/get the last-error code for a calling thread
      (API string)
  - EventData: string-319
  - EventData: 'Found reference to API "SHFileOperationW" (Indicator: "SHFileOperation";
      File: "Wii.exe")'
  - EventData: Contains reference to method used by Windows shell items (API string)
  - EventData: string-269
  - EventData: "Found string \"MoveFileW\" (Indicator: \"MoveFileW\"; File: \"Wii.exe\"\
      )\n Found string \"MoveFileExW\" (Indicator: \"MoveFileExW\"; File: \"Wii.exe\"\
      )"
  - EventData: Able to rename or move file/directory (API string)
  - EventData: string-884
  - EventData: 'Found reference to API "DeviceIoControl" (Indicator: "DeviceIoControl";
      File: "Wii.exe")'
  - EventData: Contains ability to create/control drivers (API string)
  - EventData: string-220
  - EventData: "Found reference to API \"MoveFileW\" (Indicator: \"MoveFile\"; File:\
      \ \"Wii.exe\")\n Found reference to API \"MoveFileExW\" (Indicator: \"MoveFile\"\
      ; File: \"Wii.exe\")"
  - EventData: Contains ability to move file or directory (API string)
  - EventData: string-322
  selection_network:
  - DestinationHostname: COMCTL32.dll
  - DestinationHostname: CTGP-7.pdf
  - DestinationHostname: DXGIDebug.dll
  - DestinationHostname: Deluxe.pdf
  - DestinationHostname: GDI32.dll
  - DestinationHostname: MLANG.dll
  - DestinationHostname: MSHTML.dll
  - DestinationHostname: Mii.pdf
  - DestinationHostname: PROPSYS.dll
  - DestinationHostname: SHELL32.dll
  - DestinationHostname: SHLWAPI.dll
  - DestinationHostname: SSPICLI.DLL
  - DestinationHostname: Secur32.dll
  - DestinationHostname: USER32.dll
  - DestinationHostname: UXTheme.dll
  - DestinationHostname: WININET.dll
  - DestinationHostname: WINMM.dll
  - DestinationHostname: WKSCAL.EXE
  - DestinationHostname: WLDP.DLL
  - DestinationHostname: Wii.exe
  - DestinationHostname: api-ms-win-core-synch-l1-2-0.dll
  - DestinationHostname: api-ms-win-downlevel-ole32-l1-1-0.dll
  - DestinationHostname: api-ms-win-downlevel-shlwapi-l2-1-0.dll
  - DestinationHostname: api-ms-win-rtcore-ntuser-wmpointer-l1-1-0.dll
  - DestinationHostname: cryptbase.dll
  - DestinationHostname: dwmapi.dll
  - DestinationHostname: ext-ms-win-ntuser-touch-hittest-l1-1-0.dll
  - DestinationHostname: ieframe.dll
  - DestinationHostname: kernel32.dll
  - DestinationHostname: msIso.dll
  - DestinationHostname: ntdll.dll
  - DestinationHostname: ole32.dll
  - DestinationHostname: os.dll
  - DestinationHostname: riched20.dll
  - DestinationHostname: rsaenh.dll
  - DestinationHostname: urlmon.dll
  - DestinationHostname: version.dll
  condition: selection_behavior or selection_network
