title: Trojan.Generic behavior detection (4b616059)
id: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887
status: experimental
description: Auto-generated Sigma rule for Trojan.Generic
logsource:
  product: windows
  service: sysmon
detection:
  selection_behavior:
  - EventData: "Found reference to API \"CreateFileMappingA\" (Indicator: \"CreateFile\"\
      ; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"; File:\
      \ \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\")"
  - EventData: Contains ability to create/open files (API string)
  - EventData: string-315
  - EventData: "Found reference to API \"CreateProcessA\" (Indicator: \"CreateProcess\"\
      ; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API \"CreateProcess failed: 0x{0:X8}\" (Indicator: \"\
      CreateProcess\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )"
  - EventData: Contains ability to create a new process (API string)
  - EventData: string-204
  - EventData: "\"Opera Software\\Opera GX Stable\" in Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n\
      \ \"\\BraveSoftware\\Brave-Browser\\Application\\brave.exe\" in Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n\
      \ \"SOFTWARE\\Clients\\StartMenuInternet\" in Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n\
      \ \"@echo offfor /F \"tokens=1\n2\n3 delims= \" %%A in ('reg query \"HKEY_LOCAL_MACHINE\\\
      SOFTWARE\\Microsoft\\RecoveryEnvironment\" /v TargetOS') DO SET TARGETOS=%%Cfor\
      \ /F \"tokens=1 delims=\\\" %%A in ('Echo %TARGETOS%') DO SET TARGETOSDRIVE=%%Areg\
      \ load HKLM\\\" in Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n\
      \ \"Software\\Classes\" in Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n\
      \ \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" in Source:\
      \ 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n \"\
      Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" in Source:\
      \ 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n \"\
      Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" in Source:\
      \ 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n \"\
      HARDWARE\\DESCRIPTION\\System\\BIOS\" in Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n\
      \ \"SOFTWARE\\VMware, Inc.\\VMware Tools\" in Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n\
      \ \"SOFTWARE\\Oracle\\VirtualBox Guest Additions\" in Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\n\
      \ \"HKEY_CURRENT_USER\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\
      \\Themes\\\\Personalize\" in Source: 600002e-DarkModeCS~GetWindowsColorMode\n\
      \ \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" in Source: 6000039-DarkModeCS~WindowsVersion\n\
      \ \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Themes\\\\Personalize\"\
      \ in Source: 60001ae-kzj9iJrlzI~GZmLlSlX9GgFL1xghETW\n \"Software\\\\Microsoft\\\
      \\Windows\\\\CurrentVersion\\\\Run\" in Source: 60001ea-aXjSpmUiQeny1wZNgFbnSIgCrQjTW~c383iZRQhmoYy\n\
      \ \"Opera Software\\\\Opera GX Stable\" in Source: 6000251-cctor\n \"\\\\BraveSoftware\\\
      \\Brave-Browser\\\\Application\\\\brave.exe\" in Source: 600035b-ae5yq9W4OCAE9RjK49XJExecuteAsyncd__26~MoveNext\n\
      \ \"SOFTWARE\\\\Clients\\\\StartMenuInternet\" in Source: 600037f-h3F29WxIqmTIT~N0xnISg4cZ\n\
      \ \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" in Source: 600040c-XNrFak9gYv7hFPV2I0E~8QP3shZqrVGg0lww6GfQ\n\
      \ \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\" in Source:\
      \ 600040c-XNrFak9gYv7hFPV2I0E~8QP3shZqrVGg0lww6GfQ\n \"SOFTWARE\\\\WOW6432Node\\\
      \\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" in Source: 600040c-XNrFak9gYv7hFPV2I0E~8QP3shZqrVGg0lww6GfQ\n\
      \ \"SOFTWARE\\\\WOW6432Node\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\"\
      \ in Source: 600040c-XNrFak9gYv7hFPV2I0E~8QP3shZqrVGg0lww6GfQ\n \"Software\\\
      \\Microsoft\\\\Windows\\\\Shell\\\\Associations\\\\UrlAssociations\\\\http\\\
      \\UserChoice\" in Source: 6000530-Ops6SKcVDrr7hW5zEXoXLgX~w4z1m9QdZczFTID5JF8sG\n\
      \ \"\\r\\n@echo off\\r\\nfor /F \\\"tokens=1\n2\n3 delims= \\\" %%A in ('reg\
      \ query \\\"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\RecoveryEnvironment\\\
      \" /v TargetOS') DO SET TARGETOS=%%C\\r\\n\\r\\nfor /F \\\"tokens=1 delims=\\\
      \\\\\" %%A in ('Echo %TARGETOS%') DO SET TARGETOSDRIVE=%%A\\r\\n\\r\\nreg load\
      \ HKLM\\\\\" in Source: 6000543-n1yoSOKCjwqNOdV64VBCTdvz0e~QvCIW0zlTSzHZ6W1XT\n\
      \ \"%TARGETOSDRIVE%\\\\windows\\\\system32\\\\config\\\\SOFTWARE\\r\\n\\r\\\
      nreg add HKLM\\\\\" in Source: 6000543-n1yoSOKCjwqNOdV64VBCTdvz0e~QvCIW0zlTSzHZ6W1XT\n\
      \ \"\\\"\\r\\n\\r\\nreg unload HKLM\\\\\" in Source: 6000543-n1yoSOKCjwqNOdV64VBCTdvz0e~QvCIW0zlTSzHZ6W1XT,\
      \ \"Software\\\\Classes\" in Source: 6000557-zZrXyQTvmenUO~OFgXlkz7vwg8KwQ1usP1,\
      \ \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\"\
      \ in Source: 600055a-CdQgGNLeUk~eLsAy4X1vxFn, \"Software\\\\Microsoft\\\\Windows\\\
      \\CurrentVersion\\\\Policies\\\\System\" in Source: 600055d-SBVPKhzfxpllO703QUm~meSDMAc6jPhhYZ0,\
      \ \"BraveSoftware\\\\Brave-Browser\\\\Application\\\\brave.exe\" in Source:\
      \ 60005be-cctor, \"Local\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\" in\
      \ Source: 60005be-cctor, \"Local\\\\BraveSoftware\\\\Brave-Browser\\\\KDOT\"\
      \ in Source: 60005be-cctor, \"Roaming\\\\Opera Software\\\\Opera Stable\" in\
      \ Source: 60005be-cctor, \"Roaming\\\\Opera Software\\\\KDOT\" in Source: 60005be-cctor,\
      \ \"Roaming\\\\Opera Software\\\\Opera GX Stable\" in Source: 60005be-cctor,\
      \ \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Advanced\"\
      \ in Source: 600066c-mlkUZ3nCr8tlf~XpV1KkJ9mryOVQ3, \"SOFTWARE\\\\VMware\n Inc.\\\
      \\VMware Tools\" in Source: 6000759-d00BSwJgArrPMUWRpkXl9r5~y38KrPiz6wLvsg9i,\
      \ \"SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions\" in Source: 6000759-d00BSwJgArrPMUWRpkXl9r5~y38KrPiz6wLvsg9i"
  - EventData: Contains registry location strings
  - EventData: string-120
  - EventData: "Found string \"Conhost --headless cmd.exe /c taskkill /IM\" (Indicator:\
      \ \"cmd.exe /c\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found string \"Conhost --headless cmd.exe /c taskkill /IM discord.exe /F\"\
      \ (Indicator: \"cmd.exe /c\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found string \"Conhost --headless cmd.exe /c start firefox --profile=\"\"\
      \ (Indicator: \"cmd.exe /c\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      ), Found string \"cmd.exe /c start %TARGETOSDRIVE%\\\\Recovery\\\\OEM\\\\\"\
      \ (Indicator: \"cmd.exe /c\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      ), Found string \"Conhost --headless cmd.exe /c start firefox --profile=\\\"\
      \" (Indicator: \"cmd.exe /c\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )"
  - EventData: Contains ability to executes commands or batch file
  - EventData: string-174
  - EventData: 'Found string "GetExecutingAssembly" (Indicator: "GetExecutingAssembly";
      File: "4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin")'
  - EventData: Can load assembly that contains the code that is currently executing
      (Dotnet)
  - EventData: string-615
  - EventData: "\"<Input Sample.exe\" loaded module \"%WINDIR%\\System32\\bcryptprimitives.dll\"\
      \ at 20190000\n \"<Input Sample.exe\" loaded module \"%WINDIR%\\System32\\bcrypt.dll\"\
      \ at 1FBE0000\n \"Client.exe\" loaded module \"%WINDIR%\\System32\\bcryptprimitives.dll\"\
      \ at 20190000\n \"Client.exe\" loaded module \"%WINDIR%\\System32\\bcrypt.dll\"\
      \ at 1FBE0000"
  - EventData: Loads the Bcrypt module DLL
  - EventData: module-9
  - EventData: "\"<Input Sample.exe\" loaded module \"%WINDIR%\\assembly\\NativeImages_v4.0.30319_64\\\
      mscorlib\\fe2524177eb3088c77be666722039f52\\mscorlib.ni.dll\" at F2220000\n\
      \ \"Client.exe\" loaded module \"%WINDIR%\\assembly\\NativeImages_v4.0.30319_64\\\
      mscorlib\\fe2524177eb3088c77be666722039f52\\mscorlib.ni.dll\" at F2220000"
  - EventData: Loads the .NET runtime environment
  - EventData: module-3
  - EventData: "Found reference to API (Indicator: \"GetModuleHandleA\"; File: \"\
      4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\")\n Found\
      \ reference to API (Indicator: \"QueryFullProcessImageNameA\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"CreateFileMappingA\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"CreateProcessA\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetWindowTextA\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"CreateMutexA\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"CreateCompatibleDC\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"ReleaseDC\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"CreateDC\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"DeleteDC\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetDC\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetMenuItemID\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetFinalPathNameByHandleW\"; File:\
      \ \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\")\n\
      \ Found reference to API (Indicator: \"CreateFileW\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"IsIconic\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"VirtualAlloc\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"DefWindowProc\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"CallWindowProc\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetCurrentThreadId\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetWindowThreadProcessId\"; File: \"\
      4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\")\n Found\
      \ reference to API (Indicator: \"GetCurrentProcessId\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetProcessById\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetExitCodeThread\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"ResumeThread\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"CreateThread\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"CreateRemoteThread\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"NtOpenThread\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"NtSetInformationThread\"; File: \"\
      4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\")\n Found\
      \ reference to API (Indicator: \"ExitThread\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetCurrentThread\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"NtGetContextThread\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"VirtualFree\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"SendMessage\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"PostMessage\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"RtlAdjustPrivilege\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetExtendedTcpTable\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetEnvironmentVariable\"; File: \"\
      4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\")\n Found\
      \ reference to API (Indicator: \"IsWindowVisible\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetModuleHandle\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"CloseHandle\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"DuplicateHandle\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"DeleteFile\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"MapViewOfFile\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"UnmapViewOfFile\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"NtQueryInformationFile\"; File: \"\
      4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\")\n Found\
      \ reference to API (Indicator: \"Local State\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"SeDebugPrivilege\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"SeShutdownPrivilege\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"GetCursorInfo\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API (Indicator: \"LoadLibraryA\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )"
  - EventData: Contains ability to execute Windows APIs
  - EventData: string-101
  - EventData: "\"<Input Sample.exe\" touched \"Windows Defender IOfficeAntiVirus\
      \ implementation\" (Path: \"HKLM\\SOFTWARE\\CLASSES\\CLSID\\{2781761E-28E0-4109-99FE-B9D127C57AFE}\\\
      INPROCSERVER32\")\n \"Client.exe\" touched \"NDP SymBinder\" (Path: \"HKCU\\\
      CLSID\\{0A29FF9E-7F9C-4437-8B11-F424491E3931}\\INPROCSERVER32\")"
  - EventData: Overview of unique CLSIDs touched in registry
  - EventData: registry-72
  - EventData: "Found reference to API \"ResumeThread\" (Indicator: \"ResumeThread\"\
      ; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found reference to API \"CreateThread\" (Indicator: \"CreateThread\"; File:\
      \ \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\")\n\
      \ Found reference to API \"NtOpenThread\" (Indicator: \"OpenThread\"; File:\
      \ \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\")"
  - EventData: Contains ability to retrieve/modify process thread (API string)
  - EventData: string-161
  - EventData: 'Found reference to API "GetWindowThreadProcessId" (Indicator: "GetWindowThreadProcessId";
      File: "4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin")'
  - EventData: Contains ability to show a graphical window (API string)
  - EventData: string-208
  - EventData: "\"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \ has flags like  IMAGE_FILE_32BIT_MACHINE\n IMAGE_FILE_EXECUTABLE\n \"Client.exe\"\
      \ has flags like  IMAGE_FILE_32BIT_MACHINE\n IMAGE_FILE_EXECUTABLE"
  - EventData: Uses 32 bit executable PE
  - EventData: static-153
  - EventData: "\"SELECT ProcessId, ParentProcessId FROM Win32_Process\" (Source:\
      \ 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin, Indicator:\
      \ \"select processid, parentprocessid from win32_process\")\n \"SELECT * FROM\
      \ Win32_BIOS\" (Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin,\
      \ Indicator: \"select * from win32_bios\")\n \"SELECT * FROM Win32_BaseBoard\"\
      \ (Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin,\
      \ Indicator: \"select * from win32_baseboard\")\n \"SELECT * FROM Win32_Processor\"\
      \ (Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin,\
      \ Indicator: \"select * from win32_processor\")\n \"Select * From Win32_ComputerSystem\"\
      \ (Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin,\
      \ Indicator: \"select * from win32_computersystem\")\n \"SELECT * FROM Win32_VideoController\"\
      \ (Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin,\
      \ Indicator: \"select * from win32_videocontroller\")\n \"SELECT * FROM AntivirusProduct\"\
      \ (Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin,\
      \ Indicator: \"select * from antivirusproduct\")\n \"SELECT * FROM FirewallProduct\"\
      \ (Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin,\
      \ Indicator: \"select * from firewallproduct\")\n \"Select * from Win32_ComputerSystem\"\
      \ (Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin,\
      \ Indicator: \"select * from win32_computersystem\")\n \"SELECT * FROM Win32_DiskDrive\"\
      \ (Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin,\
      \ Indicator: \"select * from win32_diskdrive\")\n \"SELECT * FROM Win32_PortConnector\"\
      \ (Source: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin,\
      \ Indicator: \"select * from win32_portconnector\")"
  - EventData: Contains SQL queries
  - EventData: string-16
  - EventData: "\"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \ file has an entrypoint instructions - \"jmp\tdword ptr [0x402000],add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,\"\n \"Client.exe\" file has an entrypoint instructions\
      \ - \"jmp\tdword ptr [0x402000],add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,\""
  - EventData: PE file entrypoint instructions
  - EventData: static-96
  - EventData: "\"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \ has COM data directory \"IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR\"\n \"Client.exe\"\
      \ has COM data directory \"IMAGE_DIRECTORY_ENTRY_COM_DESCRIPTOR\""
  - EventData: PE file contains COM data directory
  - EventData: static-144
  - EventData: "Observed namespace \"Microsoft.Win32.RegistryKey\" and TypeReference\
      \ \"OpenSubKey\" in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed namespace \"Microsoft.Win32.RegistryKey\" and TypeReference \"GetValue\"\
      \ in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed namespace \"Microsoft.Win32.RegistryKey\" and TypeReference \"GetSubKeyNames\"\
      \ in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed namespace \"Microsoft.Win32.RegistryKey\" and TypeReference \"GetValueNames\"\
      \ in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed namespace \"Microsoft.Win32.RegistryKey\" and TypeReference \"GetValueKind\"\
      \ in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed namespace \"Microsoft.Win32.RegistryKey\" and TypeReference \"OpenBaseKey\"\
      \ in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed namespace \"Microsoft.Win32.RegistryKey\" and TypeReference \"OpenSubKey\"\
      \ in \"Client.exe\"\n Observed namespace \"Microsoft.Win32.RegistryKey\" and\
      \ TypeReference \"GetValue\" in \"Client.exe\"\n Observed namespace \"Microsoft.Win32.RegistryKey\"\
      \ and TypeReference \"GetSubKeyNames\" in \"Client.exe\"\n Observed namespace\
      \ \"Microsoft.Win32.RegistryKey\" and TypeReference \"GetValueNames\" in \"\
      Client.exe\"\n Observed namespace \"Microsoft.Win32.RegistryKey\" and TypeReference\
      \ \"GetValueKind\" in \"Client.exe\"\n Observed namespace \"Microsoft.Win32.RegistryKey\"\
      \ and TypeReference \"OpenBaseKey\" in \"Client.exe\""
  - EventData: .NET code is able to query registry
  - EventData: static-138
  - EventData: 'Found string "Conhost --headless cmd.exe /c start firefox --profile=""
      (File: "4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin"),
      Found string "Conhost --headless cmd.exe /c start firefox --profile=\"" (File:
      "4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin")'
  - EventData: Able to launch web browsers via command shell
  - EventData: string-992
  - EventData: "Observed function \"System.Diagnostics.ProcessStartInfo.UseShellExecute\"\
      \ in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed function \"System.Diagnostics.ProcessStartInfo.UseShellExecute\"\
      \ in \"Client.exe\""
  - EventData: Able to execute application (.NET)
  - EventData: static-108
  - EventData: "Observed function \"Process.Start\" in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed function \"Process.set_StartInfo\" in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed function \"Process.get_StartTime\" in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed function \"Process.get_StartInfo\" in \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      \n Observed function \"Process.Start\" in \"Client.exe\"\n Observed function\
      \ \"Process.set_StartInfo\" in \"Client.exe\"\n Observed function \"Process.get_StartTime\"\
      \ in \"Client.exe\"\n Observed function \"Process.get_StartInfo\" in \"Client.exe\""
  - EventData: Contains ability to start a process (Dotnet)
  - EventData: static-111
  - EventData: "Found string \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.75.14\
      \ (KHTML, like Gecko) Version/7.0.3 Safari/7046A194A\" (Indicator: \"mozilla/5.0\
      \ (\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )\n Found string \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101\
      \ Firefox/76.0\" (Indicator: \"mozilla/5.0 (\"; File: \"4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin\"\
      )"
  - EventData: Found user-agent related strings
  - EventData: string-127
  selection_network:
  - DestinationHostname: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin
  - DestinationHostname: 4b616059ce65f7318e0b9937dc1d51512d99e54d7b592b87c4c6b3fb0a440887.bin.exe
  - DestinationHostname: Client.exe
  - DestinationHostname: api-ms-win-core-synch-l1-2-0.dll
  - DestinationHostname: kernel32.dll
  - DestinationHostname: ntdll.dll
  - DestinationHostname: tk2bt1z3v.localto.net
  - DestinationIp: 198.244.201.139
  condition: selection_behavior or selection_network
