title: Trojan.Agent behavior detection (abdd6f31)
id: abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169
status: experimental
description: Auto-generated Sigma rule for Trojan.Agent
logsource:
  product: windows
  service: sysmon
detection:
  selection_behavior:
  - EventData: "Found reference to API \"levateCreateProcess\" (Indicator: \"CreateProcess\"\
      ; Source: \"00000000-00006592.00000000.206959.00710000.00000004.mdmp, 00000000-00006592.00000001.207128.00710000.00000004.mdmp\"\
      )\n Found reference to API \"<SHIM NAME=\"ElevateCreateProcess\" COMMAND_LINE=\"\
      NoManifestCheck\">\" (Indicator: \"CreateProcess\"; Source: \"00000000-00006592.00000000.206959.00710000.00000004.mdmp,\
      \ 00000000-00006592.00000001.207128.00710000.00000004.mdmp\")\n Found reference\
      \ to API \"<HOOK MODULE=\"KERNEL32.DLL\" FUNCTION=\"CreateProcessA\"/>\" (Indicator:\
      \ \"CreateProcess\"; Source: \"00000000-00006592.00000000.206959.00710000.00000004.mdmp,\
      \ 00000000-00006592.00000001.207128.00710000.00000004.mdmp\")\n Found reference\
      \ to API \"<HOOK MODULE=\"KERNEL32.DLL\" FUNCTION=\"CreateProcessW\"/>\" (Indicator:\
      \ \"CreateProcess\"; Source: \"00000000-00006592.00000000.206959.00710000.00000004.mdmp,\
      \ 00000000-00006592.00000001.207128.00710000.00000004.mdmp\")\n Found reference\
      \ to API \"CreateProcessW\" (Indicator: \"CreateProcess\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )"
  - EventData: Contains ability to create a new process (API string)
  - EventData: string-204
  - EventData: "\"\\REGISTRY\\MACHINE\\Software\\Classes\\PackagedCom\" in Source:\
      \ 00000000-00006592.00000000.206959.00710000.00000004.mdmp\n \"istry\\Machine\\\
      Software\\Classes\\CLSID\\{FA445657-9379-11D6-B41A-00065B83EE53}\" in Source:\
      \ 00000000-00006592.00000000.206959.00710000.00000004.mdmp"
  - EventData: Contains registry location strings
  - EventData: string-120
  - EventData: 'Found reference to API "<HOOK MODULE="KERNEL32.DLL" FUNCTION="WinExec"/>"
      (Indicator: "WinExec"; Source: "00000000-00006592.00000000.206959.00710000.00000004.mdmp,
      00000000-00006592.00000001.207128.00710000.00000004.mdmp")'
  - EventData: Contains ability to execute an application (API string)
  - EventData: string-240
  - EventData: 'Found string "GetCommandLineW" (Source: "00000000-00006592.00000001.207128.008A9000.00000002.mdmp")'
  - EventData: Able to retrieve command line parameters of the running process
  - EventData: string-930
  - EventData: 'Found reference to API "CreateFileW" (Indicator: "CreateFile"; Source:
      "00000000-00006592.00000001.207128.008A9000.00000002.mdmp")'
  - EventData: Contains ability to create/open files (API string)
  - EventData: string-315
  - EventData: "\"rundll32.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcryptprimitives.dll\"\
      \ at 77150000\n \"rundll32.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcrypt.dll\"\
      \ at 72D80000"
  - EventData: Loads the Bcrypt module DLL
  - EventData: module-9
  - EventData: "Process rundll32.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\\
      Local\\SM0:6592:168:WilStaging_02\"\n Process rundll32.exe created mutex with\
      \ name  \"Local\\SM0:6592:168:WilStaging_02\""
  - EventData: Creates mutants
  - EventData: mutant-0
  - EventData: '"abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169"
      contains export function called "_a@4" at ordinal 1'
  - EventData: Contains export functions
  - EventData: static-78
  - EventData: "\"abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169\"\
      \ has flags like  IMAGE_FILE_32BIT_MACHINE\n IMAGE_FILE_EXECUTABLE"
  - EventData: Uses 32 bit executable PE
  - EventData: static-153
  - EventData: "\"abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169\"\
      \ file has an entrypoint instructions - \"add\tbyte ptr [eax], dl,ret\t,nop\t\
      word ptr cs:[eax + eax],push\tedi,push\tesi,sub\tesp, 0x134,push\t0x10005c46,ret\t\
      ,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,push\t0x134,call\t0x10005d20,add\t\
      esp, 4,test\teax, eax,mov\tdword ptr [0x10060d5b], eax,je\t0x10005826,je\t0x10005817,jmp\t\
      0x100057dc,jmp\t0x848466cf,push\tes,jne\t0x10005713,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,je\t0x1000574b,jmp\t0x1000582c,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,call\t0x1003fa10,add\tesp, 4,\""
  - EventData: PE file entrypoint instructions
  - EventData: static-96
  - EventData: "Found reference to API \"SetLastError\" (Indicator: \"SetLastError\"\
      ; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found\
      \ reference to API \"GetLastError\" (Indicator: \"GetLastError\"; Source: \"\
      00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")"
  - EventData: Contains ability to set/get the last-error code for a calling thread
      (API string)
  - EventData: string-319
  - EventData: "\"rundll32.exe\" loaded module \"API-MS-WIN-CORE-SYNCH-L1-2-0\" at\
      \ base 75bb0000\n \"rundll32.exe\" loaded module \"API-MS-WIN-CORE-FIBERS-L1-1-1\"\
      \ at base 75bb0000\n \"rundll32.exe\" loaded module \"API-MS-WIN-CORE-LOCALIZATION-L1-2-1\"\
      \ at base 75bb0000\n \"rundll32.exe\" loaded module \"KERNEL32\" at base 76920000\n\
      \ \"rundll32.exe\" loaded module \"%WINDIR%\\TEMP\\VXOLE32.DLL\" at base 72810000\n\
      \ \"rundll32.exe\" loaded module \"C:\\ABDD6F31A909B0B10E30CED74A1F6F037ADF1F61A8A842048DBC254D6F076169.DLL\"\
      \ at base 0\n \"rundll32.exe\" loaded module \"%WINDIR%\\SYSTEM32\\UXTHEME.DLL\"\
      \ at base 73970000\n \"rundll32.exe\" loaded module \"KERNEL32.DLL\" at base\
      \ 76920000\n \"rundll32.exe\" loaded module \"%WINDIR%\\SYSTEM32\\MSCTF.DLL\"\
      \ at base 763d0000\n \"rundll32.exe\" loaded module \"%WINDIR%\\SYSTEM32\\OLE32.DLL\"\
      \ at base 773a0000\n \"rundll32.exe\" loaded module \"OLEAUT32.DLL\" at base\
      \ 76a60000\n \"rundll32.exe\" loaded module \"RPCRT4.DLL\" at base 75d90000\n\
      \ \"rundll32.exe\" loaded module \"EXT-MS-WIN-RTCORE-NTUSER-WINDOW-EXT-L1-1-0.DLL\"\
      \ at base 766e0000\n \"rundll32.exe\" loaded module \"EXT-MS-WIN-RTCORE-NTUSER-INTEGRATION-L1-1-0.DLL\"\
      \ at base 766e0000\n \"rundll32.exe\" loaded module \"API-MS-WIN-CORE-COM-L1-1-0.DLL\"\
      \ at base 75f30000"
  - EventData: Loads modules at runtime
  - EventData: api-7
  - EventData: "\"rundll32.exe\" called \"LoadLibrary\" with a parameter api-ms-win-core-synch-l1-2-0\
      \ (UID: 00000000-00006592)\n \"rundll32.exe\" called \"LoadLibrary\" with a\
      \ parameter api-ms-win-core-fibers-l1-1-1 (UID: 00000000-00006592)\n \"rundll32.exe\"\
      \ called \"LoadLibrary\" with a parameter api-ms-win-core-localization-l1-2-1\
      \ (UID: 00000000-00006592)\n \"rundll32.exe\" called \"LoadLibrary\" with a\
      \ parameter kernel32 (UID: 00000000-00006592)"
  - EventData: Calls an API typically used to load libraries
  - EventData: api-175
  - EventData: '"rundll32.exe" failed to load missing module "C:\abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169.dll"
      - [base:0; Status:c0000135]'
  - EventData: Fails to load modules at runtime
  - EventData: api-22
  - EventData: '"rundll32.exe" loaded module "%WINDIR%\SysWOW64\rpcrt4.dll" at 75D90000'
  - EventData: Loads the RPC (Remote Procedure Call) module DLL
  - EventData: module-10
  - EventData: "Found reference to API (Indicator: \"GetVersionExW\"; File: \"abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169\"\
      )\n Found reference to API (Indicator: \"FlsGetValue\"; File: \"abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169\"\
      )\n Found reference to API (Indicator: \"FlsSetValue\"; File: \"abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169\"\
      )\n Found reference to API (Indicator: \"InitializeCriticalSectionEx\"; File:\
      \ \"abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169\")\n Found\
      \ reference to API (Indicator: \"LCMapStringEx\"; File: \"abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169\"\
      )\n Found reference to API (Indicator: \"LocaleNameToLCID\"; File: \"abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169\"\
      )\n Found reference to API (Indicator: \"InitializeConditionVariable\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\")\n Found reference\
      \ to API (Indicator: \"SleepConditionVariableCS\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"WakeAllConditionVariable\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\")\n Found reference\
      \ to API (Indicator: \"RtlDllShutdownInProgress\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"MessageBoxW\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"LoadIconW\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"TranslateMessage\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"DispatchMessageW\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"RegisterClassW\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"DestroyWindow\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"CreateWindowExW\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"GetWindow\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"DefWindowProcW\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"LoadCursorW\"; Source: \"00000000-00006592.00000001.207128.008A1000.00000020.mdmp\"\
      )\n Found reference to API (Indicator: \"ReadFile\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetModuleFileNameA\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"IsWow64Process2\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CreateSemaphoreExW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"HeapFree\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SetLastError\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetCommandLineW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetCurrentProcess\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"ReleaseSemaphore\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetModuleHandleExW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetSystemWow64Directory2W\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"CoUninitialize\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CoCreateInstance\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"EncodePointer\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SetErrorMode\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SetFilePointer\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"WaitForSingleObject\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"LocalAlloc\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CreateFileW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetCurrentThreadId\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"ReleaseMutex\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetSystemDirectoryW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SetProcessMitigationPolicy\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"CreateEventW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"FormatMessageW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CoInitializeSecurity\"; Source: \"\
      00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"GetLastError\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"AttachConsole\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"ReleaseSRWLockExclusive\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"OutputDebugStringW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SetEvent\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"AcquireSRWLockExclusive\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"WaitForSingleObjectEx\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"OpenSemaphoreW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CloseHandle\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"ReleaseSRWLockShared\"; Source: \"\
      00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"FreeConsole\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"HeapSetInformation\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"HeapAlloc\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"LoadStringW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"DecodePointer\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"WriteConsoleW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetProcAddress\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CreateMutexExW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"LocalFree\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"AcquireSRWLockShared\"; Source: \"\
      00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"CLSIDFromString\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"ExitProcess\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetCurrentProcessId\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetProcessHeap\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CreateProcessW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetModuleHandleW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"FreeLibrary\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"WideCharToMultiByte\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CoInitializeEx\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"DebugBreak\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"LoadLibraryExW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"IsDebuggerPresent\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"Sleep\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetStartupInfoW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"EnterCriticalSection\"; Source: \"\
      00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"LeaveCriticalSection\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"DeleteCriticalSection\"; Source: \"\
      00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"ResetEvent\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"UnhandledExceptionFilter\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"SetUnhandledExceptionFilter\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"TerminateProcess\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"QueryPerformanceCounter\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"GetSystemTimeAsFileTime\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetTickCount\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"InitializeCriticalSectionAndSpinCount\"\
      ; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found\
      \ reference to API (Indicator: \"IsProcessorFeaturePresent\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SearchPathW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CompareStringW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetFileAttributesW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CharNextW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"Wow64EnableWow64FsRedirection\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"CreateActCtxW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"ActivateActCtx\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"DeactivateActCtx\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"ReleaseActCtx\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"QueryActCtxW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"PathIsRelativeW\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"NtQuerySystemInformation\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"RtlImageNtHeader\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"NtSetInformationProcess\"; Source:\
      \ \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"NtQueryInformationToken\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"RtlNtStatusToDosError\"; Source: \"\
      00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"NtOpenProcessToken\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"NtClose\"; Source: \"00000000-00006592.00000001.207128.008A9000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"DelayLoadFailureHook\"; Source: \"\
      00000000-00006592.00000001.207128.008A9000.00000002.mdmp\")"
  - EventData: Contains ability to execute Windows APIs
  - EventData: string-101
  - EventData: "\"rundll32.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\\
      CUSTOMLOCALE\"; Key: \"EMPTY\")\n \"rundll32.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\\
      CONTROL\\NLS\\CUSTOMLOCALE\"; Key: \"EN-US\")\n \"rundll32.exe\" (Path: \"HKLM\\\
      SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\EXTENDEDLOCALE\"; Key: \"EN-US\")\n \"\
      rundll32.exe\" (Path: \"HKLM\\SYSTEM\\CONTROLSET001\\CONTROL\\NLS\\LOCALE\"\
      ; Key: \"00000409\")"
  - EventData: Reads information about supported languages
  - EventData: registry-25
  - EventData: Found registry location strings in memory
  - EventData: memorydump-10
  - EventData: "Process \"rundll32.exe\" (UID: 00000000-00006592) was launched with\
      \ new environment variables: \"PROCESSOR_ARCHITEW6432=\"AMD64\"\"\n Process\
      \ \"rundll32.exe\" (UID: 00000000-00006592) was launched with modified environment\
      \ variables: \"PROCESSOR_ARCHITECTURE, CommonProgramFiles, ProgramFiles\""
  - EventData: Process launched with changed environment
  - EventData: target-67
  - EventData: 'Process "rundll32.exe" with commandline ""C:\\abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169.dll",#1"
      (UID: 00000000-00006592)'
  - EventData: Executes a DLL using Rundll32 process
  - EventData: target-400
  - EventData: 'Found reference to API "GetCommandLineW" (Indicator: "GetCommandLine";
      Source: "00000000-00006592.00000001.207128.008A9000.00000002.mdmp")'
  selection_network:
  - DestinationHostname: abdd6f31a909b0b10e30ced74a1f6f037adf1f61a8a842048dbc254d6f076169.dll
  - DestinationHostname: api-ms-win-core-synch-l1-2-0.dll
  - DestinationHostname: kernel32.dll
  - DestinationHostname: ntdll.dll
  - DestinationHostname: rundll32.exe
  condition: selection_behavior or selection_network
