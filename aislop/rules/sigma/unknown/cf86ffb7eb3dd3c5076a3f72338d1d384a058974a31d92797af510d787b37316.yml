title: unknown behavior detection (cf86ffb7)
id: cf86ffb7eb3dd3c5076a3f72338d1d384a058974a31d92797af510d787b37316
status: experimental
description: Auto-generated Sigma rule for unknown
logsource:
  product: windows
  service: sysmon
detection:
  selection_behavior:
  - EventData: "Found reference to API \"RegCloseKey\" (Indicator: \"RegCloseKey\"\
      ; File: \"Setup.exe\")\n Found reference to API \"RegCloseKey\" (Indicator:\
      \ \"RegCloseKey\"; Source: \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\"\
      )\n Found reference to API \"RegCloseKey\" (Indicator: \"RegCloseKey\"; Source:\
      \ \"00000000-00007916.00000000.192544.00555000.00000004.mdmp, 00000000-00007916.00000000.192544.066FD000.00000004.mdmp,\
      \ 00000000-00007916.00000002.196386.0055D000.00000002.mdmp, 00000000-00007916.00000003.203757.05629000.00000004.mdmp\"\
      )"
  - EventData: Contains ability to disable/close registry key (API string)
  - EventData: string-345
  - EventData: "Found reference to API \"CreateProcessW\" (Indicator: \"CreateProcess\"\
      ; File: \"Setup.exe\")\n Found reference to API \"CreateProcessA\" (Indicator:\
      \ \"CreateProcess\"; File: \"Setup.exe\")\n Found reference to API \"CreateProcess\"\
      \ (Indicator: \"CreateProcess\"; File: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\"\
      )\n Found reference to API \"CreateProcess failed (%d).\" (Indicator: \"CreateProcess\"\
      ; File: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"CreateProcessW\" (Indicator: \"CreateProcess\"; Source:\
      \ \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\")\n Found reference\
      \ to API \"1682274999,5048,3143,,CreateProcessW,kernel32.dll,\"00:50:03.484\"\
      ,RX=0,PX=0\" (Indicator: \"CreateProcess\"; Source: \"00000000-00007684.00000001.194394.02950000.00000004.mdmp,\
      \ 00000000-00007684.00000002.196311.02950000.00000004.mdmp, 00000000-00007684.00000003.203745.02950000.00000004.mdmp\"\
      )\n Found reference to API \"CreateProcessA\" (Indicator: \"CreateProcess\"\
      ; Source: \"00000000-00007916.00000000.192544.066FD000.00000004.mdmp\")\n Found\
      \ reference to API \"CreateProcess\" (Indicator: \"CreateProcess\"; Source:\
      \ \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")\n Found reference\
      \ to API \"CreateProcess failed (%d).\" (Indicator: \"CreateProcess\"; Source:\
      \ \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")"
  - EventData: Contains ability to create a new process (API string)
  - EventData: string-204
  - EventData: "Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"\
      ; File: \"Setup.exe\")\n Found reference to API \"CreateFileA\" (Indicator:\
      \ \"CreateFile\"; File: \"Setup.exe\")\n Found reference to API \"CreateFile\"\
      \ (Indicator: \"CreateFile\"; File: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\"\
      )\n Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"; Source:\
      \ \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\")\n Found reference\
      \ to API \"CreateFileA\" (Indicator: \"CreateFile\"; Source: \"00000000-00007916.00000000.192544.066FD000.00000004.mdmp\"\
      )\n Found reference to API \"CreateFile\" (Indicator: \"CreateFile\"; Source:\
      \ \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")"
  - EventData: Contains ability to create/open files (API string)
  - EventData: string-315
  - EventData: "Found reference to API \"CreateDirectoryW\" (Indicator: \"CreateDirectory\"\
      ; File: \"Setup.exe\")\n Found reference to API \"CreateDirectoryA\" (Indicator:\
      \ \"CreateDirectory\"; File: \"Setup.exe\")\n Found reference to API \"CreateDirectoryW\"\
      \ (Indicator: \"CreateDirectory\"; Source: \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\"\
      )\n Found reference to API \"CreateDirectoryA\" (Indicator: \"CreateDirectory\"\
      ; Source: \"00000000-00007916.00000000.192544.066FD000.00000004.mdmp, 00000000-00007916.00000002.196386.0055D000.00000002.mdmp\"\
      )\n Found reference to API \"CreateDirectoryW\" (Indicator: \"CreateDirectory\"\
      ; Source: \"00000000-00007916.00000002.196386.0055D000.00000002.mdmp\")"
  - EventData: Contains ability to create directories (API string)
  - EventData: string-423
  - EventData: "\"SOFTWARE\\Borland\\Delphi\\RTL\" in Source: Setup.exe\n \"Software\\\
      CodeGear\\Locales\" in Source: Setup.exe\n \"Software\\Borland\\Locales\" in\
      \ Source: Setup.exe\n \"Software\\Borland\\Delphi\\Locales\" in Source: Setup.exe\n\
      \ \"System\\CurrentControlSet\\Control\\Keyboard Layouts\\%.8x\" in Source:\
      \ 29390-1142-00520FD4\n \"SOFTWARE\\Microsoft\\.NETFramework\\Policy\\v4.0\"\
      \ in Source: 29390-1930-004BD3F0\n \"SOFTWARE\\Microsoft\\.NETFramework\\Policy\\\
      v2.0\" in Source: 29390-1930-004BD3F0\n \"SOFTWARE\\Microsoft\\.NETFramework\\\
      Policy\\v1.1\" in Source: 29390-1930-004BD3F0\n \"SOFTWARE\\Microsoft\\.NETFramework\"\
      \ in Source: 29390-1931-004BD29C\n \"Software\\Microsoft\\Windows\\CurrentVersion\\\
      App Paths\\\" in Source: 29390-1939-004D9DF8\n \"Software\\Microsoft\\Windows\\\
      CurrentVersion\\SharedDLLs\" in Source: 29390-1979-004B7B08\n \"SOFTWARE\\Microsoft\\\
      Windows NT\\CurrentVersion\\FontSubstitutes\" in Source: 29390-4953-0043A8D0\n\
      \ \"SYSTEM\\CurrentControlSet\\Control\\Session Manager\" in Source: 29390-6187-004B8E5C\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" in Source: 29390-6426-004CD790\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\\" in Source: 29390-6575-004D4D84\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\" in Source: 29390-6671-004E51FC\n\
      \ \"System\\CurrentControlSet\\Control\\Windows\" in Source: 29390-6743-004EDBC4\n\
      \ \"System\\CurrentControlSet\\Control\\ProductOptions\" in Source: 29390-6744-004EDCA0\n\
      \ \"\\SYSTEM\\CurrentControlSet\\Control\\Keyboard Layouts\\\" in Source: 29390-7413-005479B4\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" in Source:\
      \ 29390-9916-004C6B7B\n \"Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\"\
      \ in Source: 29390-10050-004DB436\n \"@Software\\Microsoft\\Windows\\CurrentVersion\\\
      Fonts\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"Software\\Borland\\Locales\" in Source: 00000000-00007684.00000000.192471.00401000.00000020.mdmp\n\
      \ \"Software\\Borland\\Delphi\\Locales\" in Source: 00000000-00007684.00000000.192471.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Romeo Is a Dead\
      \ Man_is1\" in Source: 00000000-00007684.00000002.196311.04C00000.00000004.mdmp\n\
      \ \"Software\\Microsoft\\RestartManager\\Session0000\" in Source: 00000000-00007916.00000000.192544.03320000.00000004.mdmp\n\
      \ 00000000-00007916.00000001.194465.03320000.00000004.mdmp\n 00000000-00007916.00000002.196386.03320000.00000004.mdmp\n\
      \ 00000000-00007916.00000003.203757.03320000.00000004.mdmp\n \"stry\\Machine\\\
      Software\\Classes\\CLSID\\{FA445657-9379-11D6-B41A-00065B83EE53}\" in Source:\
      \ 00000000-00007916.00000000.192544.03320000.00000004.mdmp\n 00000000-00007916.00000003.203757.03320000.00000004.mdmp\n\
      \ \"\\REGISTRY\\MACHINE\\Software\\Classes\\PackagedCom\" in Source: 00000000-00007916.00000000.192544.03320000.00000004.mdmp\n\
      \ 00000000-00007916.00000001.194465.03320000.00000004.mdmp\n 00000000-00007916.00000002.196386.03320000.00000004.mdmp\n\
      \ 00000000-00007916.00000003.203757.03320000.00000004.mdmp\n \"SOFTWARE\\Microsoft\\\
      Windows\\CurrentVersion\\Uninstall\\Romeo Is a Dead Man_is1\" in Source: 00000000-00007916.00000000.192544.053E0000.00000004.mdmp\n\
      \ 00000000-00007916.00000000.192544.06890000.00000004.mdmp\n 00000000-00007916.00000001.194465.053E0000.00000004.mdmp\n\
      \ 00000000-00007916.00000001.194465.06890000.00000004.mdmp\n 00000000-00007916.00000002.196386.053E0000.00000004.mdmp\n\
      \ 00000000-00007916.00000002.196386.06890000.00000004.mdmp\n 00000000-00007916.00000003.203757.053E0000.00000004.mdmp\n\
      \ 00000000-00007916.00000003.203757.06890000.00000004.mdmp\n \"SOFTWARE\\Borland\\\
      Delphi\\RTL\" in Source: 00000000-00007916.00000000.192544.05621000.00000020.mdmp\n\
      \ 00000000-00007916.00000003.203757.06691000.00000020.mdmp\n \"Software\\Microsoft\\\
      Windows\\CurrentVersion\\Explorer\\User Shell Folders\" in Source: 00000000-00007916.00000002.196386.0055D000.00000002.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\"\
      \ in Source: 00000000-00007916.00000002.196386.0055D000.00000002.mdmp\n \"SOFTWARE\\\
      Microsoft\\Windows\\CurrentVersion\" in Source: 00000000-00007916.00000002.196386.0055D000.00000002.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\ProfileReconciliation\" in\
      \ Source: 00000000-00007916.00000002.196386.0055D000.00000002.mdmp\n \"Software\\\
      Borland\\Locales\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"Software\\Borland\\Delphi\\Locales\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\FontSubstitutes\" in Source:\
      \ 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n \"Software\\Microsoft\\\
      Windows\\CurrentVersion\\SharedDLLs\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"SYSTEM\\CurrentControlSet\\Control\\Session Manager\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Fonts\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows NT\\CurrentVersion\\Fonts\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\.NETFramework\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\.NETFramework\\Policy\\v4.0\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\.NETFramework\\Policy\\v2.0\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\.NETFramework\\Policy\\v1.1\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"System\\CurrentControlSet\\Control\\Windows\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n\
      \ \"System\\CurrentControlSet\\Control\\Keyboard Layouts\\%.8x\" in Source:\
      \ 00000000-00007916.00000003.203757.00401000.00000020.mdmp\n \"\\SYSTEM\\CurrentControlSet\\\
      Control\\Keyboard Layouts\\\" in Source: 00000000-00007916.00000003.203757.00401000.00000020.mdmp"
  - EventData: Contains registry location strings
  - EventData: string-120
  - EventData: "file/memory contains long string(File: \"botva2.dll\")\n file/memory\
      \ contains long string(File: \"_setup64.tmp\")\n Found string \"GetCommandLineW\"\
      \ (Source: \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\")\n Found\
      \ string \"GetCommandLineW\" (Source: \"00000000-00007916.00000000.192544.00555000.00000004.mdmp,\
      \ 00000000-00007916.00000002.196386.0055D000.00000002.mdmp\")\n Found string\
      \ \"GetCommandLineA\" (Source: \"00000000-00007916.00000000.192544.066FD000.00000004.mdmp,\
      \ 00000000-00007916.00000003.203757.05629000.00000004.mdmp\")"
  - EventData: Able to retrieve command line parameters of the running process
  - EventData: string-930
  - EventData: "Found reference to API \"LoadResource\" (Indicator: \"LoadResource\"\
      ; File: \"Setup.exe\")\n Found reference to API \"FindResourceW\" (Indicator:\
      \ \"FindResource\"; File: \"Setup.exe\")\n Found reference to API \"LockResource\"\
      \ (Indicator: \"LockResource\"; File: \"Setup.exe\")\n Found reference to API\
      \ \"SizeofResource\" (Indicator: \"SizeofResource\"; File: \"Setup.exe\")\n\
      \ Found reference to API \"FreeResource\" (Indicator: \"FreeResource\"; File:\
      \ \"Setup.exe\")\n Found reference to API \"SizeofResource\" (Indicator: \"\
      SizeofResource\"; Source: \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\"\
      )\n Found reference to API \"LockResource\" (Indicator: \"LockResource\"; Source:\
      \ \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\")\n Found reference\
      \ to API \"LoadResource\" (Indicator: \"LoadResource\"; Source: \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\"\
      )\n Found reference to API \"FindResourceW\" (Indicator: \"FindResource\"; Source:\
      \ \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\")\n Found reference\
      \ to API \"LockResource\" (Indicator: \"LockResource\"; Source: \"00000000-00007916.00000002.196386.0055D000.00000002.mdmp\"\
      )\n Found reference to API \"LoadResource\" (Indicator: \"LoadResource\"; Source:\
      \ \"00000000-00007916.00000002.196386.0055D000.00000002.mdmp\")\n Found reference\
      \ to API \"FindResourceExW\" (Indicator: \"FindResource\"; Source: \"00000000-00007916.00000002.196386.0055D000.00000002.mdmp\"\
      )"
  - EventData: Contains ability to find and load resources of specific modules (API
      string)
  - EventData: string-550
  - EventData: "Found reference to API \"SetLastError\" (Indicator: \"SetLastError\"\
      ; File: \"Setup.exe\")\n Found reference to API \"GetLastError\" (Indicator:\
      \ \"GetLastError\"; File: \"Setup.exe\")\n Found reference to API \"SetLastError\"\
      \ (Indicator: \"SetLastError\"; Source: \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\"\
      )\n Found reference to API \"GetLastError\" (Indicator: \"GetLastError\"; Source:\
      \ \"00000000-00007684.00000000.192471.00417000.00000004.mdmp\")\n Found reference\
      \ to API \"GetLastError\" (Indicator: \"GetLastError\"; Source: \"00000000-00007916.00000000.192544.066FD000.00000004.mdmp,\
      \ 00000000-00007916.00000002.196386.0055D000.00000002.mdmp\")"
  - EventData: Contains ability to set/get the last-error code for a calling thread
      (API string)
  - EventData: string-319
  - EventData: "Found reference to API \"ShellExecuteW\" (Indicator: \"ShellExecute\"\
      ; File: \"Setup.exe\")\n Found reference to API \"ShellExecuteExW\" (Indicator:\
      \ \"ShellExecute\"; File: \"Setup.exe\")\n Found reference to API \"ShellExecuteEx\
      \ failed (%d).\" (Indicator: \"ShellExecute\"; File: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\"\
      )\n Found reference to API \"ShellExecuteEx\" (Indicator: \"ShellExecute\";\
      \ File: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"ShellExecuteEx returned hProcess=0\" (Indicator: \"ShellExecute\"\
      ; File: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"ShellExecuteEx failed (%d).\" (Indicator: \"ShellExecute\"\
      ; Source: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"ShellExecuteEx\" (Indicator: \"ShellExecute\"; Source:\
      \ \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")\n Found reference\
      \ to API \"ShellExecuteEx returned hProcess=0\" (Indicator: \"ShellExecute\"\
      ; Source: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")"
  - EventData: Contains ability to execute an application (API string)
  - EventData: string-240
  - EventData: "Found reference to API \"MoveFileA\" (Indicator: \"MoveFile\"; File:\
      \ \"Setup.exe\")\n Found reference to API \"MoveFileExA\" (Indicator: \"MoveFile\"\
      ; File: \"Setup.exe\")\n Found reference to API \"MoveFileW\" (Indicator: \"\
      MoveFile\"; File: \"Setup.exe\")\n Found reference to API \"MoveFileExW\" (Indicator:\
      \ \"MoveFile\"; File: \"Setup.exe\")\n Found reference to API \"MoveFileEx\"\
      \ (Indicator: \"MoveFile\"; File: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\"\
      )\n Found reference to API \"MoveFileEx failed (%d).\" (Indicator: \"MoveFile\"\
      ; File: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"MoveFile\" (Indicator: \"MoveFile\"; File: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\"\
      )\n Found reference to API \"MoveFileA\" (Indicator: \"MoveFile\"; Source: \"\
      00000000-00007916.00000000.192544.066FD000.00000004.mdmp\")\n Found reference\
      \ to API \"MoveFileExA\" (Indicator: \"MoveFile\"; Source: \"00000000-00007916.00000000.192544.066FD000.00000004.mdmp\"\
      )\n Found reference to API \"MoveFile\" (Indicator: \"MoveFile\"; Source: \"\
      00000000-00007916.00000003.203757.00401000.00000020.mdmp\")\n Found reference\
      \ to API \"MoveFileEx\" (Indicator: \"MoveFile\"; Source: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\"\
      )\n Found reference to API \"MoveFileEx failed (%d).\" (Indicator: \"MoveFile\"\
      ; Source: \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\")"
  - EventData: Contains ability to move file or directory (API string)
  - EventData: string-322
  - EventData: "\"Setup.exe\" with parameter %TEMP%\\is-FC4JO.tmp (UID: 00000000-00007684)\n\
      \ \"Setup.tmp\" with parameter %TEMP%\\is-ONL7J.tmp (UID: 00000000-00007916)\n\
      \ \"Setup.tmp\" with parameter %TEMP%\\is-ONL7J.tmp\\_isetup (UID: 00000000-00007916)"
  - EventData: Creates directory on disk
  - EventData: api-318
  - EventData: "Found reference to API \"ShowWindow\" (Indicator: \"ShowWindow\";\
      \ File: \"Setup.exe\")\n Found reference to API \"GetWindowThreadProcessId\"\
      \ (Indicator: \"GetWindowThreadProcessId\"; File: \"Setup.exe\")\n Found reference\
      \ to API \"ShowWindow\" (Indicator: \"ShowWindow\"; Source: \"00000000-00007916.00000000.192544.00555000.00000004.mdmp,\
      \ 00000000-00007916.00000000.192544.066FD000.00000004.mdmp, 00000000-00007916.00000003.203757.05629000.00000004.mdmp\"\
      )\n Found reference to API \"GetWindowThreadProcessId\" (Indicator: \"GetWindowThreadProcessId\"\
      ; Source: \"00000000-00007916.00000000.192544.00555000.00000004.mdmp\")"
  - EventData: Contains ability to show a graphical window (API string)
  - EventData: string-208
  - EventData: "Found registry modification API: \"RegCreateKeyExW\" in file \"Setup.exe\"\
      \n Found registry modification API: \"RegCreateKeyEx\" in file \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\"\
      \n Found registry modification API: \"RegCreateKeyExA\" in \"00000000-00007916.00000002.196386.0055D000.00000002.mdmp\"\
      \n Found registry modification API: \"RegCreateKeyEx\" in \"00000000-00007916.00000003.203757.00401000.00000020.mdmp\""
  - EventData: Able to create/load registry keys (API string)
  - EventData: string-307
  - EventData: 'Found reference to API "DeviceIoControl" (Indicator: "DeviceIoControl";
      File: "Setup.exe")'
  - EventData: Contains ability to create/control drivers (API string)
  - EventData: string-220
  - EventData: "\"Setup.exe\" writes to a file \"C:\\Users\\%OSUSER%\\AppData\\Local\\\
      Temp\\is-FC4JO.tmp\\Setup.tmp\"\n \"Setup.tmp\" writes to a file \"C:\\Users\\\
      %OSUSER%\\AppData\\Local\\Temp\\is-ONL7J.tmp\\_isetup\\_setup64.tmp\"\n \"Setup.tmp\"\
      \ writes to a file \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\is-ONL7J.tmp\\\
      _isetup\\_shfoldr.dll\"\n \"Setup.tmp\" writes to a file \"C:\\Users\\%OSUSER%\\\
      AppData\\Local\\Temp\\is-ONL7J.tmp\\ISDone.dll\"\n \"Setup.tmp\" writes to a\
      \ file \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\is-ONL7J.tmp\\botva2.dll\"\
      \n \"Setup.tmp\" writes to a file \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\\
      is-ONL7J.tmp\\logo.png\"\n \"Setup.tmp\" writes to a file \"C:\\Users\\%OSUSER%\\\
      AppData\\Local\\Temp\\is-ONL7J.tmp\\Lockscreen_overlay.png\"\n \"Setup.tmp\"\
      \ writes to a file \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\is-ONL7J.tmp\\\
      Dark.png\"\n \"Setup.tmp\" writes to a file \"C:\\Users\\%OSUSER%\\AppData\\\
      Local\\Temp\\is-ONL7J.tmp\\Light.png\"\n \"Setup.tmp\" writes to a file \"C:\\\
      Users\\%OSUSER%\\AppData\\Local\\Temp\\is-ONL7J.tmp\\Lockscreen.jpg\""
  - EventData: Writes files in a temp directory
  - EventData: api-267
  - EventData: "\"Setup.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcryptprimitives.dll\"\
      \ at 74DB0000\n \"Setup.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcrypt.dll\"\
      \ at 73420000\n \"Setup.tmp\" loaded module \"%WINDIR%\\SysWOW64\\bcryptprimitives.dll\"\
      \ at 74DB0000\n \"Setup.tmp\" loaded module \"%WINDIR%\\SysWOW64\\bcrypt.dll\"\
      \ at 73420000"
  - EventData: Loads the Bcrypt module DLL
  - EventData: module-9
  - EventData: "Process Setup.tmp created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\\
      Local\\SM0:7916:168:WilStaging_02\"\n Process Setup.tmp created mutex with name\
      \  \"\\Sessions\\1\\BaseNamedObjects\\RstrMgr3887CAB8-533F-4C85-B0DC-3E5639F8D511\"\
      \n Process Setup.tmp created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\\
      RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0000\"\n Process Setup.tmp\
      \ created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\SM0:7916:64:WilError_01\"\
      \n Process Setup.tmp created mutex with name  \"Local\\SM0:7916:168:WilStaging_02\"\
      \n Process Setup.tmp created mutex with name  \"SM0:7916:64:WilError_01\"\n\
      \ Process Setup.tmp created mutex with name  \"RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0000\"\
      \n Process Setup.tmp created mutex with name  \"RstrMgr3887CAB8-533F-4C85-B0DC-3E5639F8D511\""
  - EventData: Creates mutants
  - EventData: mutant-0
  - EventData: "\"Setup.exe\" loaded module \"API-MS-WIN-CORE-SYNCH-L1-2-0\" at base\
      \ 77150000\n \"Setup.exe\" loaded module \"API-MS-WIN-CORE-FIBERS-L1-1-1\" at\
      \ base 77150000\n \"Setup.exe\" loaded module \"API-MS-WIN-CORE-LOCALIZATION-L1-2-1\"\
      \ at base 77150000\n \"Setup.exe\" loaded module \"KERNEL32\" at base 775b0000\n\
      \ \"Setup.exe\" loaded module \"%WINDIR%\\TEMP\\VXOLE32.DLL\" at base 72c20000\n\
      \ \"Setup.exe\" loaded module \"SHELL32.DLL\" at base 74e70000\n \"Setup.exe\"\
      \ loaded module \"COMCTL32.DLL\" at base 72cf0000\n \"Setup.exe\" loaded module\
      \ \"KERNEL32.DLL\" at base 775b0000\n \"Setup.exe\" loaded module \"%WINDIR%\\\
      SYSTEM32\\UXTHEME.DLL\" at base 73b50000\n \"Setup.exe\" loaded module \"NTDLL.DLL\"\
      \ at base 77680000\n \"Setup.exe\" loaded module \"%WINDIR%\\SYSTEM32\\APPHELP.DLL\"\
      \ at base 73ff0000\n \"Setup.tmp\" loaded module \"API-MS-WIN-CORE-SYNCH-L1-2-0\"\
      \ at base 77150000\n \"Setup.tmp\" loaded module \"API-MS-WIN-CORE-FIBERS-L1-1-1\"\
      \ at base 77150000\n \"Setup.tmp\" loaded module \"API-MS-WIN-CORE-LOCALIZATION-L1-2-1\"\
      \ at base 77150000\n \"Setup.tmp\" loaded module \"KERNEL32\" at base 775b0000\n\
      \ \"Setup.tmp\" loaded module \"%WINDIR%\\TEMP\\VXOLE32.DLL\" at base 72c20000\n\
      \ \"Setup.tmp\" loaded module \"IMM32.DLL\" at base 747e0000\n \"Setup.tmp\"\
      \ loaded module \"%WINDIR%\\SYSTEM32\\UXTHEME.DLL\" at base 73b50000\n \"Setup.tmp\"\
      \ loaded module \"KERNEL32.DLL\" at base 775b0000\n \"Setup.tmp\" loaded module\
      \ \"UXTHEME.DLL\" at base 73b50000\n \"Setup.tmp\" loaded module \"SHELL32.DLL\"\
      \ at base 74e70000\n \"Setup.tmp\" loaded module \"OLEAUT32.DLL\" at base 76670000\n\
      \ \"Setup.tmp\" loaded module \"RPCRT4.DLL\" at base 742e0000\n \"Setup.tmp\"\
      \ loaded module \"EXT-MS-WIN-RTCORE-NTUSER-WINDOW-EXT-L1-1-0.DLL\" at base 762f0000\n\
      \ \"Setup.tmp\" loaded module \"EXT-MS-WIN-RTCORE-NTUSER-INTEGRATION-L1-1-0.DLL\"\
      \ at base 762f0000\n \"Setup.tmp\" loaded module \"API-MS-WIN-CORE-COM-L1-1-0.DLL\"\
      \ at base 74590000\n \"Setup.tmp\" loaded module \"%WINDIR%\\SYSTEM32\\MSCTF.DLL\"\
      \ at base 740d0000\n \"Setup.tmp\" loaded module \"SHFOLDER.DLL\" at base 727e0000\n\
      \ \"Setup.tmp\" loaded module \"RSTRTMGR.DLL\" at base 727b0000\n \"Setup.tmp\"\
      \ loaded module \"%WINDIR%\\SYSTEM32\\BCRYPTPRIMITIVES.DLL\" at base 74db0000\n\
      \ \"Setup.tmp\" loaded module \"USER32\" at base 762f0000\n \"Setup.tmp\" loaded\
      \ module \"USER32.DLL\" at base 762f0000\n \"Setup.tmp\" loaded module \"GDI32.DLL\"\
      \ at base 77340000\n \"Setup.tmp\" loaded module \"%TEMP%\\IS-ONL7J.TMP\\ISDONE.DLL\"\
      \ at base 6690000\n \"Setup.tmp\" loaded module \"GDI32\" at base 77340000\n\
      \ \"Setup.tmp\" loaded module \"GDIPLUS\" at base 73d20000\n \"Setup.tmp\" loaded\
      \ module \"%TEMP%\\IS-ONL7J.TMP\\BOTVA2.DLL\" at base 5620000\n \"Setup.tmp\"\
      \ loaded module \"%WINDIR%\\WINSXS\\X86_MICROSOFT.WINDOWS.GDIPLUS_6595B64144CCF1DF_1.1.16299.248_NONE_8E66FBC1026DF8AB\\\
      GDIPLUS.DLL\" at base 73d20000\n \"Setup.tmp\" loaded module \"WINDOWSCODECS.DLL\"\
      \ at base 71b60000\n \"Setup.tmp\" loaded module \"COMCTL32.DLL\" at base 72cf0000\n\
      \ \"Setup.tmp\" loaded module \"%WINDIR%\\SYSTEM32\\OLE32.DLL\" at base 76510000"
  - EventData: Loads modules at runtime
  - EventData: api-7
  - EventData: "\"Setup.exe\" has flags like  IMAGE_FILE_32BIT_MACHINE\n IMAGE_FILE_EXECUTABLE\n\
      \ \"ISDone.dll\" has flags like  IMAGE_FILE_32BIT_MACHINE\n IMAGE_FILE_EXECUTABLE\n\
      \ \"botva2.dll\" has flags like  IMAGE_FILE_32BIT_MACHINE\n IMAGE_FILE_EXECUTABLE\n\
      \ \"Setup.tmp\" has flags like  IMAGE_FILE_32BIT_MACHINE\n IMAGE_FILE_EXECUTABLE"
  - EventData: Uses 32 bit executable PE
  - EventData: static-153
  - EventData: "\"Setup.exe\" file has an entrypoint instructions - \"push\tebp,mov\t\
      ebp, esp,add\tesp, -0x5c,push\tebx,push\tesi,push\tedi,xor\teax, eax,mov\tdword\
      \ ptr [ebp - 0x3c], eax,mov\tdword ptr [ebp - 0x40], eax,mov\tdword ptr [ebp\
      \ - 0x5c], eax,mov\tdword ptr [ebp - 0x30], eax,mov\tdword ptr [ebp - 0x38],\
      \ eax,mov\tdword ptr [ebp - 0x34], eax,mov\tdword ptr [ebp - 0x2c], eax,mov\t\
      dword ptr [ebp - 0x28], eax,mov\tdword ptr [ebp - 0x14], eax,mov\teax, 0x4152b8,call\t\
      0x406854,xor\teax, eax,push\tebp,push\t0x416b45,push\tdword ptr fs:[eax],mov\t\
      dword ptr fs:[eax], esp,xor\tedx, edx,push\tebp,push\t0x416b01,push\tdword ptr\
      \ fs:[edx],mov\tdword ptr fs:[edx], esp,mov\teax, dword ptr [0x41ab48],call\t\
      0x415124,call\t0x414cd0,lea\tedx, [ebp - 0x14],xor\teax, eax,\"\n \"ISDone.dll\"\
      \ file has an entrypoint instructions - \"push\tebp,mov\tebp, esp,add\tesp,\
      \ -0x3c,mov\teax, 0x41fcb0,call\t0x405604,call\t0x403c94,lea\teax, [eax],add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,\"\n \"botva2.dll\" file\
      \ has an entrypoint instructions - \"push\tebp,mov\tebp, esp,add\tesp, -0x3c,mov\t\
      eax, 0x408058,call\t0x403cc4,call\t0x402f28,lea\teax, [eax],add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax],\
      \ al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\t\
      byte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte\
      \ ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr [eax], al,add\tbyte ptr\
      \ [eax], al,add\tbyte ptr [eax], al,\"\n \"Setup.tmp\" file has an entrypoint\
      \ instructions - \"push\tebp,mov\tebp, esp,add\tesp, -0x10,push\tebx,push\t\
      esi,push\tedi,mov\teax, 0x54a710,call\t0x409104,push\t-0x14,mov\teax, dword\
      \ ptr [0x550238],mov\teax, dword ptr [eax],mov\tebx, dword ptr [eax + 0x170],push\t\
      ebx,call\t0x40a0ac,and\teax, 0xffffff7f,push\teax,push\t-0x14,mov\teax, dword\
      \ ptr [0x550238],push\tebx,call\t0x40a31c,xor\teax, eax,push\tebp,push\t0x54c10f,push\t\
      dword ptr fs:[eax],mov\tdword ptr fs:[eax], esp,push\t1,call\t0x4099f4,call\t\
      0x54a454,mov\teax, dword ptr [0x54a348],push\teax,push\t0x54a3ac,\"\n \"_setup64.tmp\"\
      \ file has an entrypoint instructions - \"sub\trsp, 0x28,call\t0x1400012a4,mov\t\
      ecx, eax,call\tqword ptr [rip + 0xb8f],int3\t,add\tbyte ptr [rax], al,add\t\
      byte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte\
      \ ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr\
      \ [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax],\
      \ al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\t\
      byte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte\
      \ ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr\
      \ [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax],\
      \ al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\t\
      byte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte\
      \ ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr\
      \ [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax],\
      \ al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\tbyte ptr [rax], al,add\t\
      byte ptr [rax], al,\""
  - EventData: PE file entrypoint instructions
  - EventData: static-96
  selection_network:
  - DestinationHostname: .3u.tmp
  - DestinationHostname: .3u.txt
  - DestinationHostname: 1.ee
  - DestinationHostname: 4.tmp
  - DestinationHostname: 5.5.1.ee
  - DestinationHostname: COMMAND.COM
  - DestinationHostname: D.COM
  - DestinationHostname: DWMAPI.DLL
  - DestinationHostname: Fusion.dll
  - DestinationHostname: ISDone.dll
  - DestinationHostname: Items.ItemData
  - DestinationHostname: MSFTEDIT.DLL
  - DestinationHostname: NINIT.INI
  - DestinationHostname: Rstrtmgr.dll
  - DestinationHostname: Setup.EN
  - DestinationHostname: Setup.ENU
  - DestinationHostname: Setup.exe
  - DestinationHostname: Setup.tmp
  - DestinationHostname: TScriptRunner.LoadScript
  - DestinationHostname: TScriptRunner.SetPSExecParameters
  - DestinationHostname: USER32.DLL
  - DestinationHostname: WININIT.INI
  - DestinationHostname: advapi32.dll
  - DestinationHostname: api-ms-win-core-synch-l1-2-0.dll
  - DestinationHostname: botva2.dll
  - DestinationHostname: cmd.exe
  - DestinationHostname: comctl32.dll
  - DestinationHostname: d.bin
  - DestinationHostname: d.exe
  - DestinationHostname: desktop.ini
  - DestinationHostname: et.lnk
  - DestinationHostname: gdi32.dll
  - DestinationHostname: imm32.dll
  - DestinationHostname: is-FC4JO.tmp
  - DestinationHostname: is-ONL7J.tmp
  - DestinationHostname: iscrypt.dll
  - DestinationHostname: isdecmp.dll
  - DestinationHostname: kernel32.dll
  - DestinationHostname: l32.dll
  - DestinationHostname: ntdll.dll
  - DestinationHostname: ole32.dll
  - DestinationHostname: oleacc.dll
  - DestinationHostname: oleaut32.dll
  - DestinationHostname: regsvr32.exe
  - DestinationHostname: restools.hanzify.org
  - DestinationHostname: s.bin
  - DestinationHostname: sfc.dll
  - DestinationHostname: shell32.dll
  - DestinationHostname: shfolder.dll
  - DestinationHostname: shfoldr.dll
  - DestinationHostname: shlwapi.dll
  - DestinationHostname: uxtheme.dll
  - DestinationHostname: vapi32.dll
  - DestinationHostname: www.innosetup.com
  condition: selection_behavior or selection_network
