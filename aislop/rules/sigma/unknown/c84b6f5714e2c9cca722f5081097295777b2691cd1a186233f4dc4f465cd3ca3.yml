title: unknown behavior detection (c84b6f57)
id: c84b6f5714e2c9cca722f5081097295777b2691cd1a186233f4dc4f465cd3ca3
status: experimental
description: Auto-generated Sigma rule for unknown
logsource:
  product: windows
  service: sysmon
detection:
  selection_behavior:
  - EventData: "Found reference to API \"RegCloseKey\" (Indicator: \"RegCloseKey\"\
      ; File: \"setup.exe\")\n Found reference to API \"RegCloseKey\" (Indicator:\
      \ \"RegCloseKey\"; Source: \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\"\
      )\n Found reference to API \"RegCloseKey\" (Indicator: \"RegCloseKey\"; Source:\
      \ \"00000000-00004880.00000000.222994.00555000.00000004.mdmp, 00000000-00004880.00000000.222994.0115E000.00000004.mdmp,\
      \ 00000000-00004880.00000000.222994.0576D000.00000004.mdmp, 00000000-00004880.00000001.224915.00555000.00000004.mdmp,\
      \ 00000000-00004880.00000001.224915.0576D000.00000004.mdmp, 00000000-00004880.00000002.226836.06AD9000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.0055D000.00000002.mdmp, 00000000-00004880.00000003.234211.0685C000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.729D7000.00000002.mdmp\")"
  - EventData: Contains ability to disable/close registry key (API string)
  - EventData: string-345
  - EventData: "Found reference to API \"CreateProcessW\" (Indicator: \"CreateProcess\"\
      ; File: \"setup.exe\")\n file/memory contains long string with (Indicator: \"\
      CreateProcess\"; File: \"cls-magic2l.dll\")\n file/memory contains long string\
      \ with (Indicator: \"CreateProcess\"; File: \"cls-lollypop.dll\")\n file/memory\
      \ contains long string with (Indicator: \"CreateProcess\"; File: \"rzw.exe\"\
      )\n Found reference to API \"CreateProcess\" (Indicator: \"CreateProcess\";\
      \ File: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"CreateProcess failed (%d).\" (Indicator: \"CreateProcess\"\
      ; File: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"CreateProcessA\" (Indicator: \"CreateProcess\"; File: \"\
      setup.exe\")\n Found reference to API \"CreateProcessW\" (Indicator: \"CreateProcess\"\
      ; Source: \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\")\n Found\
      \ reference to API \"1633133135,3380,3143,,CreateProcessW,kernel32.dll,\"00:57:59.281\"\
      ,RX=0,PX=0\" (Indicator: \"CreateProcess\"; Source: \"00000000-00004444.00000000.222926.02FC0000.00000004.mdmp,\
      \ 00000000-00004444.00000002.226765.02FC0000.00000004.mdmp, 00000000-00004444.00000003.234199.02FC0000.00000004.mdmp\"\
      )\n Found reference to API \"CreateProcessA\" (Indicator: \"CreateProcess\"\
      ; Source: \"00000000-00004880.00000000.222994.0115E000.00000004.mdmp, 00000000-00004880.00000003.234211.0685C000.00000004.mdmp\"\
      )\n Found reference to API \"CreateProcess\" (Indicator: \"CreateProcess\";\
      \ Source: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"CreateProcess failed (%d).\" (Indicator: \"CreateProcess\"\
      ; Source: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\")"
  - EventData: Contains ability to create a new process (API string)
  - EventData: string-204
  - EventData: "Found reference to API \"CreateDirectoryW\" (Indicator: \"CreateDirectory\"\
      ; File: \"setup.exe\")\n file/memory contains long string with (Indicator: \"\
      CreateDirectory\"; File: \"rzw.exe\")\n Found reference to API \"CreateDirectoryA\"\
      \ (Indicator: \"CreateDirectory\"; File: \"setup.exe\")\n Found reference to\
      \ API \"CreateDirectoryW\" (Indicator: \"CreateDirectory\"; Source: \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\"\
      )\n Found reference to API \"CreateDirectoryA\" (Indicator: \"CreateDirectory\"\
      ; Source: \"00000000-00004880.00000000.222994.0115E000.00000004.mdmp, 00000000-00004880.00000003.234211.0055D000.00000002.mdmp,\
      \ 00000000-00004880.00000003.234211.0685C000.00000004.mdmp\")\n Found reference\
      \ to API \"CreateDirectoryW\" (Indicator: \"CreateDirectory\"; Source: \"00000000-00004880.00000003.234211.0055D000.00000002.mdmp\"\
      )"
  - EventData: Contains ability to create directories (API string)
  - EventData: string-423
  - EventData: "Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"\
      ; File: \"setup.exe\")\n file/memory contains long string with (Indicator: \"\
      CreateFile\"; File: \"cls-magic2l.dll\")\n file/memory contains long string\
      \ with (Indicator: \"CreateFile\"; File: \"cls-lollypop.dll\")\n file/memory\
      \ contains long string with (Indicator: \"CreateFile\"; File: \"rzw.exe\")\n\
      \ Found reference to API \"CreateFileMappingW\" (Indicator: \"CreateFile\";\
      \ File: \"setup.exe\")\n Found reference to API \"CreateFile\" (Indicator: \"\
      CreateFile\"; File: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\"\
      )\n Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"; Source:\
      \ \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\")\n Found reference\
      \ to API \"BASS_StreamCreateFile\" (Indicator: \"CreateFile\"; Source: \"00000000-00004444.00000000.222926.05130000.00000004.mdmp\"\
      )\n Found reference to API \"CreateFileMappingA\" (Indicator: \"CreateFile\"\
      ; Source: \"00000000-00004444.00000000.222926.05130000.00000004.mdmp\")\n Found\
      \ reference to API \"CreateFileA\" (Indicator: \"CreateFile\"; Source: \"00000000-00004880.00000000.222994.0115E000.00000004.mdmp,\
      \ 00000000-00004880.00000000.222994.0576D000.00000004.mdmp, 00000000-00004880.00000000.222994.1002A000.00000002.mdmp,\
      \ 00000000-00004880.00000001.224915.0576D000.00000004.mdmp, 00000000-00004880.00000003.234211.0685C000.00000004.mdmp\"\
      )\n Found reference to API \"BASS_StreamCreateFile\" (Indicator: \"CreateFile\"\
      ; Source: \"00000000-00004880.00000000.222994.05410000.00000004.mdmp, 00000000-00004880.00000000.222994.0A6C0000.00000004.mdmp,\
      \ 00000000-00004880.00000001.224915.05410000.00000004.mdmp, 00000000-00004880.00000001.224915.0A6C0000.00000004.mdmp,\
      \ 00000000-00004880.00000001.224915.1104B000.00000040.mdmp, 00000000-00004880.00000002.226836.05410000.00000004.mdmp,\
      \ 00000000-00004880.00000002.226836.0A6C0000.00000004.mdmp, 00000000-00004880.00000003.234211.05410000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.0A6C0000.00000004.mdmp\")\n Found reference\
      \ to API \"CreateFileMappingA\" (Indicator: \"CreateFile\"; Source: \"00000000-00004880.00000000.222994.05410000.00000004.mdmp,\
      \ 00000000-00004880.00000000.222994.0A6C0000.00000004.mdmp, 00000000-00004880.00000001.224915.05410000.00000004.mdmp,\
      \ 00000000-00004880.00000001.224915.0A6C0000.00000004.mdmp, 00000000-00004880.00000002.226836.05410000.00000004.mdmp,\
      \ 00000000-00004880.00000002.226836.0A6C0000.00000004.mdmp, 00000000-00004880.00000003.234211.05410000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.0A6C0000.00000004.mdmp\")\n Found reference\
      \ to API \"CreateFileW\" (Indicator: \"CreateFile\"; Source: \"00000000-00004880.00000000.222994.1002A000.00000002.mdmp\"\
      )\n Found reference to API \"BASS_StreamCreateFileUser\" (Indicator: \"CreateFile\"\
      ; Source: \"00000000-00004880.00000001.224915.1104B000.00000040.mdmp\")\n Found\
      \ reference to API \"CreateFile\" (Indicator: \"CreateFile\"; Source: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\"\
      )"
  - EventData: Contains ability to create/open files (API string)
  - EventData: string-315
  - EventData: "Found reference to API \"SizeofResource\" (Indicator: \"SizeofResource\"\
      ; File: \"setup.exe\")\n Found reference to API \"LockResource\" (Indicator:\
      \ \"LockResource\"; File: \"setup.exe\")\n Found reference to API \"LoadResource\"\
      \ (Indicator: \"LoadResource\"; File: \"setup.exe\")\n Found reference to API\
      \ \"FindResourceW\" (Indicator: \"FindResource\"; File: \"setup.exe\")\n Found\
      \ reference to API \"FindResourceExW\" (Indicator: \"FindResource\"; File: \"\
      setup.exe\")\n Found reference to API \"FreeResource\" (Indicator: \"FreeResource\"\
      ; File: \"setup.exe\")\n Found reference to API \"SizeofResource\" (Indicator:\
      \ \"SizeofResource\"; Source: \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\"\
      )\n Found reference to API \"LockResource\" (Indicator: \"LockResource\"; Source:\
      \ \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\")\n Found reference\
      \ to API \"LoadResource\" (Indicator: \"LoadResource\"; Source: \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\"\
      )\n Found reference to API \"FindResourceW\" (Indicator: \"FindResource\"; Source:\
      \ \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\")\n Found reference\
      \ to API \"LockResource\" (Indicator: \"LockResource\"; Source: \"00000000-00004880.00000003.234211.0055D000.00000002.mdmp\"\
      )\n Found reference to API \"LoadResource\" (Indicator: \"LoadResource\"; Source:\
      \ \"00000000-00004880.00000003.234211.0055D000.00000002.mdmp, 00000000-00004880.00000003.234211.729D7000.00000002.mdmp\"\
      )\n Found reference to API \"FindResourceExW\" (Indicator: \"FindResource\"\
      ; Source: \"00000000-00004880.00000003.234211.0055D000.00000002.mdmp, 00000000-00004880.00000003.234211.729D7000.00000002.mdmp\"\
      )\n Found reference to API \"SizeofResource\" (Indicator: \"SizeofResource\"\
      ; Source: \"00000000-00004880.00000003.234211.729D7000.00000002.mdmp\")"
  - EventData: Contains ability to find and load resources of specific modules (API
      string)
  - EventData: string-550
  - EventData: details too long to display
  - EventData: Contains ability to execute Windows APIs
  - EventData: string-101
  - EventData: "Found reference to API \"OpenProcessToken\" (Indicator: \"OpenProcess\"\
      ; File: \"setup.exe\")\n Found reference to API \"GetProcessHeap\" (Indicator:\
      \ \"GetProcessHeap\"; File: \"setup.exe\")\n Found reference to API \"OpenProcess\"\
      \ (Indicator: \"OpenProcess\"; File: \"setup.exe\")\n Found reference to API\
      \ \"OpenProcessToken\" (Indicator: \"OpenProcess\"; Source: \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\"\
      )\n Found reference to API \"GetProcessHeap\" (Indicator: \"GetProcessHeap\"\
      ; Source: \"00000000-00004880.00000000.222994.0115E000.00000004.mdmp, 00000000-00004880.00000000.222994.1002A000.00000002.mdmp,\
      \ 00000000-00004880.00000003.234211.729D7000.00000002.mdmp\")\n Found reference\
      \ to API \"OpenProcess\" (Indicator: \"OpenProcess\"; Source: \"00000000-00004880.00000000.222994.0115E000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.0685C000.00000004.mdmp\")"
  - EventData: Contains ability to retrieve/open a process (API string)
  - EventData: string-272
  - EventData: "\"SOFTWARE\\Borland\\Delphi\\RTL\" in Source: setup.exe\n \"Software\\\
      CodeGear\\Locales\" in Source: setup.exe\n \"Software\\Borland\\Locales\" in\
      \ Source: setup.exe\n \"Software\\Borland\\Delphi\\Locales\" in Source: setup.exe\n\
      \ \"System\\CurrentControlSet\\Control\\Keyboard Layouts\\%.8x\" in Source:\
      \ 11933-1142-00520FD4\n \"SOFTWARE\\Microsoft\\.NETFramework\\Policy\\v4.0\"\
      \ in Source: 11933-1930-004BD3F0\n \"SOFTWARE\\Microsoft\\.NETFramework\\Policy\\\
      v2.0\" in Source: 11933-1930-004BD3F0\n \"SOFTWARE\\Microsoft\\.NETFramework\\\
      Policy\\v1.1\" in Source: 11933-1930-004BD3F0\n \"SOFTWARE\\Microsoft\\.NETFramework\"\
      \ in Source: 11933-1931-004BD29C\n \"Software\\Microsoft\\Windows\\CurrentVersion\\\
      App Paths\\\" in Source: 11933-1939-004D9DF8\n \"Software\\Microsoft\\Windows\\\
      CurrentVersion\\SharedDLLs\" in Source: 11933-1979-004B7B08\n \"SOFTWARE\\Microsoft\\\
      Windows NT\\CurrentVersion\\FontSubstitutes\" in Source: 11933-4953-0043A8D0\n\
      \ \"SYSTEM\\CurrentControlSet\\Control\\Session Manager\" in Source: 11933-6187-004B8E5C\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" in Source: 11933-6426-004CD790\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\\" in Source: 11933-6575-004D4D84\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\" in Source: 11933-6671-004E51FC\n\
      \ \"System\\CurrentControlSet\\Control\\Windows\" in Source: 11933-6743-004EDBC4\n\
      \ \"System\\CurrentControlSet\\Control\\ProductOptions\" in Source: 11933-6744-004EDCA0\n\
      \ \"\\SYSTEM\\CurrentControlSet\\Control\\Keyboard Layouts\\\" in Source: 11933-7413-005479B4\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\" in Source:\
      \ 11933-9916-004C6B7B\n \"Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\"\
      \ in Source: 11933-10050-004DB436\n \"@Software\\Microsoft\\Windows\\CurrentVersion\\\
      Fonts\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"Software\\Borland\\Locales\" in Source: 00000000-00004444.00000003.234199.00401000.00000020.mdmp\n\
      \ \"Software\\Borland\\Delphi\\Locales\" in Source: 00000000-00004444.00000003.234199.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\RestartManager\\Session0000\" in Source: 00000000-00004880.00000000.222994.03380000.00000004.mdmp\n\
      \ 00000000-00004880.00000001.224915.03380000.00000004.mdmp\n 00000000-00004880.00000002.226836.03380000.00000004.mdmp\n\
      \ 00000000-00004880.00000003.234211.03380000.00000004.mdmp\n \"SOFTWARE\\Microsoft\\\
      Windows NT\\CurrentVersion\\AppCompatFlags\\Layers\\\" in Source: 00000000-00004880.00000000.222994.05410000.00000004.mdmp\n\
      \ 00000000-00004880.00000001.224915.05410000.00000004.mdmp\n 00000000-00004880.00000002.226836.05410000.00000004.mdmp\n\
      \ 00000000-00004880.00000003.234211.05410000.00000004.mdmp\n \"Software\\Microsoft\\\
      Windows\\CurrentVersion\\Uninstall\\DYNASTY WARRIORS: ORIGINS_is1\" in Source:\
      \ 00000000-00004880.00000000.222994.05410000.00000004.mdmp\n \"SOFTWARE\\Borland\\\
      Delphi\\RTL\" in Source: 00000000-00004880.00000000.222994.06801000.00000020.mdmp\n\
      \ 00000000-00004880.00000001.224915.05761000.00000020.mdmp\n 00000000-00004880.00000002.226836.06AD1000.00000020.mdmp\n\
      \ \"\\REGISTRY\\MACHINE\\Software\\Microsoft\\WindowsRuntime\" in Source: 00000000-00004880.00000001.224915.03380000.00000004.mdmp\n\
      \ 00000000-00004880.00000002.226836.03380000.00000004.mdmp\n 00000000-00004880.00000003.234211.03380000.00000004.mdmp\n\
      \ \"stry\\Machine\\Software\\Classes\\CLSID\\{FA445657-9379-11D6-B41A-00065B83EE53}\"\
      \ in Source: 00000000-00004880.00000001.224915.03380000.00000004.mdmp\n 00000000-00004880.00000002.226836.03380000.00000004.mdmp\n\
      \ 00000000-00004880.00000003.234211.03380000.00000004.mdmp\n \"Software\\Borland\\\
      Locales\" in Source: 00000000-00004880.00000001.224915.05761000.00000020.mdmp\n\
      \ 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n \"Software\\Borland\\\
      Delphi\\Locales\" in Source: 00000000-00004880.00000001.224915.05761000.00000020.mdmp\n\
      \ 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n \"SOFTWARE\\Microsoft\\\
      Windows NT\\CurrentVersion\\AppCompatFlags\\CaretTracking\" in Source: 00000000-00004880.00000001.224915.72971000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Input\" in Source: 00000000-00004880.00000001.224915.72971000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\OOBE\" in Source: 00000000-00004880.00000001.224915.72971000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Authentication\\CFL\\ExperienceManagerData\"\
      \ in Source: 00000000-00004880.00000001.224915.72971000.00000020.mdmp\n \"SOFTWARE\\\
      Microsoft\\Windows NT\\CurrentVersion\\FontSubstitutes\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\SharedDLLs\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"SYSTEM\\CurrentControlSet\\Control\\Session Manager\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Fonts\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows NT\\CurrentVersion\\Fonts\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\.NETFramework\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\.NETFramework\\Policy\\v4.0\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\.NETFramework\\Policy\\v2.0\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\.NETFramework\\Policy\\v1.1\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\App Paths\\\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"System\\CurrentControlSet\\Control\\Windows\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"System\\CurrentControlSet\\Control\\Keyboard Layouts\\%.8x\" in Source:\
      \ 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n \"\\SYSTEM\\CurrentControlSet\\\
      Control\\Keyboard Layouts\\\" in Source: 00000000-00004880.00000003.234211.00401000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\"\
      \ in Source: 00000000-00004880.00000003.234211.0055D000.00000002.mdmp\n \"Software\\\
      Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell Folders\" in Source: 00000000-00004880.00000003.234211.0055D000.00000002.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\" in Source: 00000000-00004880.00000003.234211.0055D000.00000002.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\ProfileReconciliation\" in\
      \ Source: 00000000-00004880.00000003.234211.0055D000.00000002.mdmp"
  - EventData: Contains registry location strings
  - EventData: string-120
  - EventData: "file/memory contains long string(File: \"ISDone.dll\")\n file/memory\
      \ contains long string(File: \"idp.dll\")\n file/memory contains long string(File:\
      \ \"rz-1.03.7-stdio.exe\")\n file/memory contains long string(File: \"rz.exe\"\
      )\n file/memory contains long string(File: \"cls-srep_x86.exe\")\n file/memory\
      \ contains long string(File: \"x5.exe\")\n file/memory contains long string(File:\
      \ \"cls-lollypop_x64.exe\")\n file/memory contains long string(File: \"cls-lollypop_x86.exe\"\
      )\n file/memory contains long string(File: \"raw2hif_dll.dll\")\n file/memory\
      \ contains long string(File: \"hif2raw_dll.dll\")\n file/memory contains long\
      \ string(File: \"innocallback.dll\")\n file/memory contains long string(File:\
      \ \"botva2.dll\")\n file/memory contains long string(File: \"FlushFileCache.exe\"\
      )\n file/memory contains long string(File: \"_setup64.tmp\")\n Found string\
      \ \"GetCommandLineW\" (Source: \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\"\
      )\n Found string \"GetCommandLineW\" (Source: \"00000000-00004880.00000000.222994.00555000.00000004.mdmp,\
      \ 00000000-00004880.00000001.224915.00555000.00000004.mdmp, 00000000-00004880.00000003.234211.0055D000.00000002.mdmp\"\
      )\n Found string \"GetCommandLineA\" (Source: \"00000000-00004880.00000000.222994.0115E000.00000004.mdmp,\
      \ 00000000-00004880.00000000.222994.0576D000.00000004.mdmp, 00000000-00004880.00000000.222994.1002A000.00000002.mdmp,\
      \ 00000000-00004880.00000001.224915.0576D000.00000004.mdmp, 00000000-00004880.00000002.226836.06AD9000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.0685C000.00000004.mdmp\")"
  - EventData: Able to retrieve command line parameters of the running process
  - EventData: string-930
  - EventData: "Found reference to API \"GetLastError\" (Indicator: \"GetLastError\"\
      ; File: \"setup.exe\")\n Found reference to API \"SetLastError\" (Indicator:\
      \ \"SetLastError\"; File: \"setup.exe\")\n file/memory contains long string\
      \ with (Indicator: \"GetLastError\"; File: \"rzw.exe\")\n Found reference to\
      \ API \"SetLastError\" (Indicator: \"SetLastError\"; Source: \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\"\
      )\n Found reference to API \"GetLastError\" (Indicator: \"GetLastError\"; Source:\
      \ \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\")\n Found reference\
      \ to API \"GetLastError\" (Indicator: \"GetLastError\"; Source: \"00000000-00004880.00000000.222994.0115E000.00000004.mdmp,\
      \ 00000000-00004880.00000000.222994.0576D000.00000004.mdmp, 00000000-00004880.00000000.222994.1002A000.00000002.mdmp,\
      \ 00000000-00004880.00000001.224915.0576D000.00000004.mdmp, 00000000-00004880.00000003.234211.0055D000.00000002.mdmp,\
      \ 00000000-00004880.00000003.234211.0685C000.00000004.mdmp, 00000000-00004880.00000003.234211.6B088000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.729D7000.00000002.mdmp\")\n Found reference\
      \ to API \"SetLastError\" (Indicator: \"SetLastError\"; Source: \"00000000-00004880.00000000.222994.1002A000.00000002.mdmp,\
      \ 00000000-00004880.00000003.234211.729D7000.00000002.mdmp\")"
  - EventData: Contains ability to set/get the last-error code for a calling thread
      (API string)
  - EventData: string-319
  - EventData: 'file/memory contains long string with (Indicator: "GetExecutingAssembly";
      File: "hosts.exe")'
  - EventData: Can load assembly that contains the code that is currently executing
      (Dotnet)
  - EventData: string-615
  - EventData: "Pattern match: \"rdata@.data.rsrc\"\n Pattern match: \"ijya@i99d3.zinw\""
  - EventData: Found E-Mail address in binary/memory
  - EventData: string-63
  - EventData: "Found reference to API \"GetCommandLineW\" (Indicator: \"GetCommandLine\"\
      ; File: \"setup.exe\")\n Found reference to API \"GetCommandLineA\" (Indicator:\
      \ \"GetCommandLine\"; File: \"setup.exe\")\n Found reference to API \"CommandLineToArgvW\"\
      \ (Indicator: \"CommandLineToArgv\"; File: \"setup.exe\")\n Found reference\
      \ to API \"GetCommandLineW\" (Indicator: \"GetCommandLine\"; Source: \"00000000-00004444.00000000.222926.00417000.00000004.mdmp\"\
      )\n Found reference to API \"GetCommandLineW\" (Indicator: \"GetCommandLine\"\
      ; Source: \"00000000-00004880.00000000.222994.00555000.00000004.mdmp, 00000000-00004880.00000001.224915.00555000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.0055D000.00000002.mdmp\")\n Found reference\
      \ to API \"GetCommandLineA\" (Indicator: \"GetCommandLine\"; Source: \"00000000-00004880.00000000.222994.0115E000.00000004.mdmp,\
      \ 00000000-00004880.00000000.222994.0576D000.00000004.mdmp, 00000000-00004880.00000000.222994.1002A000.00000002.mdmp,\
      \ 00000000-00004880.00000001.224915.0576D000.00000004.mdmp, 00000000-00004880.00000002.226836.06AD9000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.0685C000.00000004.mdmp\")\n Found reference\
      \ to API \"CommandLineToArgvW\" (Indicator: \"CommandLineToArgv\"; Source: \"\
      00000000-00004880.00000003.234211.0055D000.00000002.mdmp\")"
  - EventData: Contains ability to retrieve the command-line string for the current
      process (API string)
  - EventData: string-206
  - EventData: "Found reference to API \"ShellExecuteEx failed (%d).\" (Indicator:\
      \ \"ShellExecute\"; File: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\"\
      )\n Found reference to API \"ShellExecuteEx\" (Indicator: \"ShellExecute\";\
      \ File: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"ShellExecuteEx returned hProcess=0\" (Indicator: \"ShellExecute\"\
      ; File: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"ShellExecuteEx failed (%d).\" (Indicator: \"ShellExecute\"\
      ; Source: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\")\n Found\
      \ reference to API \"ShellExecuteEx\" (Indicator: \"ShellExecute\"; Source:\
      \ \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\")\n Found reference\
      \ to API \"ShellExecuteEx returned hProcess=0\" (Indicator: \"ShellExecute\"\
      ; Source: \"00000000-00004880.00000003.234211.00401000.00000020.mdmp\")"
  - EventData: Contains ability to execute an application (API string)
  - EventData: string-240
  - EventData: "file/memory contains long string with (Indicator: \"CreateThread\"\
      ; File: \"cls-lollypop.dll\")\n Found reference to API \"SuspendThread\" (Indicator:\
      \ \"SuspendThread\"; File: \"setup.exe\")\n Found reference to API \"SetThreadContext\"\
      \ (Indicator: \"SetThreadContext\"; File: \"setup.exe\")\n Found reference to\
      \ API \"GetThreadContext\" (Indicator: \"GetThreadContext\"; File: \"setup.exe\"\
      )\n Found reference to API \"CreateThread\" (Indicator: \"CreateThread\"; Source:\
      \ \"00000000-00004880.00000000.222994.00555000.00000004.mdmp, 00000000-00004880.00000000.222994.0115E000.00000004.mdmp,\
      \ 00000000-00004880.00000000.222994.1002A000.00000002.mdmp, 00000000-00004880.00000001.224915.00555000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.0685C000.00000004.mdmp\")\n Found reference\
      \ to API \"SuspendThread\" (Indicator: \"SuspendThread\"; Source: \"00000000-00004880.00000000.222994.0115E000.00000004.mdmp,\
      \ 00000000-00004880.00000003.234211.0685C000.00000004.mdmp\")\n Found reference\
      \ to API \"ResumeThread\" (Indicator: \"ResumeThread\"; Source: \"00000000-00004880.00000000.222994.0115E000.00000004.mdmp,\
      \ 00000000-00004880.00000000.222994.1002A000.00000002.mdmp, 00000000-00004880.00000003.234211.0685C000.00000004.mdmp\"\
      )\n Found reference to API \"CreateThreadpoolTimer\" (Indicator: \"CreateThread\"\
      ; Source: \"00000000-00004880.00000003.234211.729D7000.00000002.mdmp\")"
  - EventData: Contains ability to retrieve/modify process thread (API string)
  - EventData: string-161
  - EventData: "\"setup.exe\" with parameter %TEMP%\\is-M824L.tmp (UID: 00000000-00004444)\n\
      \ \"setup.tmp\" with parameter %TEMP%\\is-0TD4N.tmp (UID: 00000000-00004880)\n\
      \ \"setup.tmp\" with parameter %TEMP%\\is-0TD4N.tmp\\_isetup (UID: 00000000-00004880)"
  - EventData: Creates directory on disk
  - EventData: api-318
  - EventData: "\"setup.exe\" writes to a file \"C:\\Users\\%OSUSER%\\AppData\\Local\\\
      Temp\\is-M824L.tmp\\setup.tmp\"\n \"setup.tmp\" writes to a file \"C:\\Users\\\
      %OSUSER%\\AppData\\Local\\Temp\\is-0TD4N.tmp\\_isetup\\_setup64.tmp\"\n \"setup.tmp\"\
      \ writes to a file \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\is-0TD4N.tmp\\\
      _isetup\\_shfoldr.dll\"\n \"setup.tmp\" writes to a file \"C:\\Users\\%OSUSER%\\\
      AppData\\Local\\Temp\\is-0TD4N.tmp\\idp.dll\"\n \"setup.tmp\" writes to a file\
      \ \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\is-0TD4N.tmp\\innocallback.dll\"\
      \n \"setup.tmp\" writes to a file \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\\
      is-0TD4N.tmp\\ISDone.dll\"\n \"setup.tmp\" writes to a file \"C:\\Users\\%OSUSER%\\\
      AppData\\Local\\Temp\\is-0TD4N.tmp\\wintb.dll\"\n \"setup.tmp\" writes to a\
      \ file \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\is-0TD4N.tmp\\BASS.dll\"\
      \n \"setup.tmp\" writes to a file \"C:\\Users\\%OSUSER%\\AppData\\Local\\Temp\\\
      is-0TD4N.tmp\\cls-lollypop.dll\"\n \"setup.tmp\" writes to a file \"C:\\Users\\\
      %OSUSER%\\AppData\\Local\\Temp\\is-0TD4N.tmp\\cls-lollypop_x64.exe\""
  - EventData: Writes files in a temp directory
  - EventData: api-267
  - EventData: Found string - \\.\pipe\InnoSetup64BitHelper-%.8x-%.8x-%.8x-%.8x%.8x
  - EventData: Found named pipe like strings
  - EventData: string-146
  - EventData: 'Observed system executable string:"%WINDIR%\system32\shlwapi.dll"
      [Source: 00000000-00004880-00000C2B-2460649390]'
  - EventData: References Windows file paths for DLLs (possible dropped files)
  - EventData: string-625
  - EventData: "\"setup.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcryptprimitives.dll\"\
      \ at 746D0000\n \"setup.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcrypt.dll\"\
      \ at 73990000\n \"setup.tmp\" loaded module \"%WINDIR%\\SysWOW64\\bcryptprimitives.dll\"\
      \ at 746D0000\n \"setup.tmp\" loaded module \"%WINDIR%\\SysWOW64\\bcrypt.dll\"\
      \ at 73990000"
  - EventData: Loads the Bcrypt module DLL
  - EventData: module-9
  selection_network:
  - DestinationHostname: .3u.tmp
  - DestinationHostname: .3u.txt
  - DestinationHostname: 1.ee
  - DestinationHostname: 4.tmp
  - DestinationHostname: 5.5.1.ee
  - DestinationHostname: BASS.dll
  - DestinationHostname: COMMAND.COM
  - DestinationHostname: D.COM
  - DestinationHostname: DWMAPI.DLL
  - DestinationHostname: Fusion.dll
  - DestinationHostname: ISDone.dll
  - DestinationHostname: Items.ItemData
  - DestinationHostname: MSACM32.dll
  - DestinationHostname: MSFTEDIT.DLL
  - DestinationHostname: MSVCRT.dll
  - DestinationHostname: NINIT.INI
  - DestinationHostname: Rstrtmgr.dll
  - DestinationHostname: TScriptRunner.LoadScript
  - DestinationHostname: TScriptRunner.SetPSExecParameters
  - DestinationHostname: USER32.DLL
  - DestinationHostname: WININIT.INI
  - DestinationHostname: WINMM.dll
  - DestinationHostname: advapi32.dll
  - DestinationHostname: api-ms-win-core-synch-l1-2-0.dll
  - DestinationHostname: botva2.dll
  - DestinationHostname: callbackctrl.dll
  - DestinationHostname: cmd.exe
  - DestinationHostname: comctl32.dll
  - DestinationHostname: d.bin
  - DestinationHostname: d.exe
  - DestinationHostname: desktop.ini
  - DestinationHostname: et.lnk
  - DestinationHostname: idp.dll
  - DestinationHostname: imm32.dll
  - DestinationHostname: innocallback.EN
  - DestinationHostname: innocallback.ENU
  - DestinationHostname: innocallback.dll
  - DestinationHostname: is-0TD4N.tmp
  - DestinationHostname: is-M824L.tmp
  - DestinationHostname: iscrypt.dll
  - DestinationHostname: isdecmp.dll
  - DestinationHostname: kernel32.dll
  - DestinationHostname: l32.dll
  - DestinationHostname: music.mp
  - DestinationHostname: ntdll.dll
  - DestinationHostname: ole32.dll
  - DestinationHostname: oleacc.dll
  - DestinationHostname: oleaut32.dll
  - DestinationHostname: regsvr32.exe
  - DestinationHostname: restools.hanzify.org
  - DestinationHostname: s.bin
  - DestinationHostname: setup.EN
  - DestinationHostname: setup.ENU
  - DestinationHostname: setup.exe
  - DestinationHostname: setup.tmp
  - DestinationHostname: sfc.dll
  - DestinationHostname: shell32.dll
  - DestinationHostname: shfolder.dll
  - DestinationHostname: shfoldr.dll
  - DestinationHostname: shlwapi.dll
  - DestinationHostname: uxtheme.dll
  - DestinationHostname: vapi32.dll
  - DestinationHostname: wintb.dll
  - DestinationHostname: www.innosetup.com
  condition: selection_behavior or selection_network
