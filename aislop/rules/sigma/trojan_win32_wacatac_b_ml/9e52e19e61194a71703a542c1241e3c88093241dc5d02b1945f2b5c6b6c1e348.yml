title: Trojan_Win32_Wacatac_B_ml behavior detection (9e52e19e)
id: 9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348
status: experimental
description: Auto-generated Sigma rule for Trojan_Win32_Wacatac_B_ml
logsource:
  product: windows
  service: sysmon
detection:
  selection_behavior:
  - EventData: "Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"\
      ; File: \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\"\
      )\n Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"; Source:\
      \ \"00000000-00007828.00000001.222514.06400000.00000004.mdmp, 00000000-00008028.00000000.221898.01241000.00000002.mdmp,\
      \ 00000000-00008028.00000001.222737.6EAF5000.00000002.mdmp\")\n Found reference\
      \ to API \"CreateFileMappingW\" (Indicator: \"CreateFile\"; Source: \"00000000-00008028.00000000.221898.01241000.00000002.mdmp\"\
      )"
  - EventData: Contains ability to create/open files (API string)
  - EventData: string-315
  - EventData: "Found reference to API \"GetLastError\" (Indicator: \"GetLastError\"\
      ; File: \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\"\
      )\n Found reference to API \"SetLastError\" (Indicator: \"SetLastError\"; File:\
      \ \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\")\n\
      \ Found reference to API \"SetLastError\" (Indicator: \"SetLastError\"; Source:\
      \ \"00000000-00008028.00000000.221898.01241000.00000002.mdmp, 00000000-00008028.00000001.222737.6EAF5000.00000002.mdmp\"\
      )\n Found reference to API \"GetLastError\" (Indicator: \"GetLastError\"; Source:\
      \ \"00000000-00008028.00000000.221898.01241000.00000002.mdmp, 00000000-00008028.00000001.222737.6EAF5000.00000002.mdmp\"\
      )"
  - EventData: Contains ability to set/get the last-error code for a calling thread
      (API string)
  - EventData: string-319
  - EventData: '"github.com/ncruces/go-sqlite3.Pointer" (Indicator: "github.com")'
  - EventData: Found well known domains (string)
  - EventData: string-135
  - EventData: "\"\\REGISTRY\\MACHINE\\Software\\Classes\\PackagedCom\" in Source:\
      \ 00000000-00005084.00000001.220950.02C90000.00000004.mdmp\n \"REGISTRY\\USER\\\
      S-1-5-21-735145574-3570218355-1207367261-1001\\Software\\Policies\\Microsoft\\\
      Windows\\Safer\\CodeIdentifiers\" in Source: 00000000-00005084.00000001.220950.02C90000.00000004.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\Cryptography\" in Source: 00000000-00007828.00000001.222514.06400000.00000004.mdmp\n\
      \ \"o enable assembly bind failure logging, set the registry value [HKLM\\Software\\\
      Microsoft\\Fusion!EnableLog] (DWORD) to 1.\" in Source: 00000000-00008028.00000000.221898.00910000.00000004.mdmp\n\
      \ 00000000-00008028.00000001.222737.00932000.00000004.mdmp\n \"o turn this feature\
      \ off, remove the registry value [HKLM\\Software\\Microsoft\\Fusion!EnableLog].\"\
      \ in Source: 00000000-00008028.00000000.221898.00910000.00000004.mdmp\n 00000000-00008028.00000001.222737.00932000.00000004.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\Cryptography\\Defaults\\Provider\\Microsoft Enhanced\
      \ RSA and AES Cryptographic Provider\" in Source: 00000000-00008028.00000000.221898.009F7000.00000004.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\PowerShell\\%1!ls!\\PowerShellEngine\" in Source: 00000000-00008028.00000000.221898.01231000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\PowerShell\" in Source: 00000000-00008028.00000000.221898.01231000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\PowerShell\\%1!ls!\" in Source: 00000000-00008028.00000000.221898.01231000.00000020.mdmp\n\
      \ \"SYSTEM\\CurrentControlSet\\Control\\MiniNT\" in Source: 00000000-00008028.00000000.221898.01231000.00000020.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\PowerShell\\3\" in Source: 00000000-00008028.00000000.221898.01231000.00000020.mdmp\n\
      \ \"Software\\Microsoft\\Active Setup\\Installed Components\\{89820200-ECBD-11CF-8B85-00AA005B4383}\"\
      \ in Source: 00000000-00008028.00000000.221898.01231000.00000020.mdmp\n \"System\\\
      CurrentControlSet\\Control\\Nls\\RegionMapping\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"System\\CurrentControlSet\\Control\\MiniNT\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"Software\\Microsoft\\PowerShell\\\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\.NETFramework\\AppContext\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\WSMAN\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\WSMAN\"\
      \ in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n \"Software\\\
      Microsoft\\PowerShell\\3\\PowerShellEngine\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"HKEY_LOCAL_MACHINE\\Software\\Microsoft\\PowerShell\\3\\PowerShellEngine\"\
      \ in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n \"Software\\\
      Policies\\Microsoft\\Windows\\PowerShell\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"Software\\Policies\\Microsoft\\Windows\\PowerShell\\ModuleLogging\" in Source:\
      \ 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n \"HKEY_LOCAL_MACHINE\\\
      Software\\Policies\\Microsoft\\Windows\\PowerShell\\ModuleLogging\" in Source:\
      \ 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n \"HKEY_CURRENT_USER\\\
      Software\\Policies\\Microsoft\\Windows\\PowerShell\\ModuleLogging\" in Source:\
      \ 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n \"Software\\Policies\\\
      Microsoft\\Windows\\PowerShell\\Transcription\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\\
      Transcription\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"HKEY_CURRENT_USER\\Software\\Policies\\Microsoft\\Windows\\PowerShell\\\
      Transcription\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"Software\\Policies\\Microsoft\\Windows\\PowerShell\\ConsoleSessionConfiguration\"\
      \ in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n \"HKEY_CURRENT_USER\\\
      Software\\Policies\\Microsoft\\Windows\\PowerShell\\ConsoleSessionConfiguration\"\
      \ in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n \"HKEY_LOCAL_MACHINE\\\
      Software\\Policies\\Microsoft\\Windows\\PowerShell\\ConsoleSessionConfiguration\"\
      \ in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n \"SOFTWARE\\\
      Microsoft\\Windows NT\\CurrentVersion\\Time Zones\\Pacific Standard Time\\Dynamic\
      \ DST\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Time\
      \ Zones\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Time Zones\" in Source:\
      \ 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n \"SOFTWARE\\Microsoft\\\
      Windows NT\\CurrentVersion\\Time Zones\\Pacific Standard Time\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Time\
      \ Zones\\Pacific Standard Time\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Time\
      \ Zones\\Pacific Standard Time\\Dynamic DST\" in Source: 00000000-00008028.00000000.221898.04840000.00000004.mdmp\n\
      \ \"Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\\
      \" in Source: 00000000-00008028.00000001.222737.07100000.00000004.mdmp"
  - EventData: Contains registry location strings
  - EventData: string-120
  - EventData: "Pattern match: \"putin@kremlin.ru\"\n Pattern match: \"chambersroot@chambersign.org\"\
      \n Pattern match: \"premium-server@thawte.com\"\n Pattern match: \"mium-server@thawte.com\""
  - EventData: Found E-Mail address in binary/memory
  - EventData: string-63
  - EventData: "Found string \"GetCommandLineW\" (Source: \"00000000-00005484.00000001.223198.06900000.00000004.mdmp\"\
      )\n Found string \"GetCommandLineW\" (Source: \"00000000-00007828.00000001.222514.06400000.00000004.mdmp\"\
      )"
  - EventData: Able to retrieve command line parameters of the running process
  - EventData: string-930
  - EventData: 'Found reference to API "RegCloseKey" (Indicator: "RegCloseKey"; Source:
      "00000000-00007828.00000001.222514.06400000.00000004.mdmp, 00000000-00008028.00000000.221898.01241000.00000002.mdmp")'
  - EventData: Contains ability to disable/close registry key (API string)
  - EventData: string-345
  - EventData: "file/memory contains long string with (Indicator: \"mozilla/5.0 (\"\
      ; File: \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\"\
      )\n file/memory contains long string with (Indicator: \"user-agent: \"; File:\
      \ \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\")"
  - EventData: Found user-agent related strings
  - EventData: string-127
  - EventData: "Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\ops\\function.rs\" (Indicator: \"/rustc/\"; File: \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\alloc\\src\\vec\\mod.rs\" (Indicator: \"/rustc/\"; File: \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\"\
      )\n Found reference string \"()/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\str\\pattern.rs\" (Indicator: \"/rustc/\"; File: \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\"\
      )\n Found reference string \"note: Some details are omitted, run with `RUST_BACKTRACE=full`\
      \ for a verbose backtrace.__rust_end_short_backtrace__rust_begin_short_backtraces\
      \      [... omitted  frame ...]\" (Indicator: \"rust_backtrace\"; File: \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\"\
      )\n Found reference string \"RUST_BACKTRACEmainfailed to generate unique thread\
      \ ID: bitspace exhausted\" (Indicator: \"rust_backtrace\"; File: \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\"\
      )\n Found reference string \"note: run with `RUST_BACKTRACE=1` environment variable\
      \ to display a backtrace\" (Indicator: \"rust_backtrace\"; File: \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\"\
      )\n Found reference string \"rust_panic\" (Indicator: \"rust_panic\"; File:\
      \ \"9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin\")"
  - EventData: Contains artifacts from Rust programming language
  - EventData: string-943
  - EventData: '"CyptInMemory.pdb"'
  - EventData: Contains PDB pathways
  - EventData: string-7
  - EventData: 'Found string "Import-Module" (Indicator: "Import-Module"; Source:
      "00000000-00008028.00000000.221898.04840000.00000004.mdmp")'
  - EventData: Contains ability to add modules to the current session (Powershell
      command string)
  - EventData: string-348
  - EventData: 'Found string "Invoke-Expression" (Indicator: "Invoke-Expression";
      Source: "00000000-00008028.00000000.221898.04840000.00000004.mdmp")'
  - EventData: Contains ability to run commands or expressions (Powershell command
      string)
  - EventData: string-288
  - EventData: "\"CREATE TABLE x\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"create\
      \ table x\")\n \"CREATE TABLE %Q.'%q_%q'(%s)%s\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"create\
      \ table %q.'%q_%q'(%s)%s\"), \"SELECT word\n rank\n NULL\n langid\n id FROM\
      \ \"%w\".\"%w_vocab\"%s\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"select\
      \ word\n rank\n null\n langid\n id from \"%w\".\"%w_vocab\"%s\"), \"SELECT rowid\n\
      \ rank FROM %Q.%Q ORDER BY %s(\"%w\"%s%s) %s\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"select\
      \ rowid\n rank from %q.%q order by %s(\"%w\"%s%s) %s\"), \"INSERT INTO\"%w\"\
      .\"%w_rowid\"(rowid,nodeno)VALUES(?1,?2)ON CONFLICT(rowid)DO UPDATE SET nodeno=excluded.nodeno\"\
      \ (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp, 00000000-00001824.00000002.225105.2A470000.00000004.mdmp,\
      \ Indicator: \"insert into\"%w\".\"%w_rowid\"(rowid,nodeno)values(?1,?2)on conflict(rowid)do\
      \ update set nodeno=excluded.nodeno\"), \"CREATE TABLE \"%w\".\"%w_rowid\"(rowid\
      \ INTEGER PRIMARY KEY,nodeno\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"create\
      \ table \"%w\".\"%w_rowid\"(rowid integer primary key,nodeno\")\n \"SELECT iLang,\
      \ cFrom, cTo, iCost FROM \"%w\" WHERE iLang>=0 ORDER BY iLang\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"select\
      \ ilang, cfrom, cto, icost from \"%w\" where ilang>=0 order by ilang\")\n \"\
      SELECT idx,count(*) FROM %Q.sqlite_stat4 GROUP BY idx COLLATE nocase\" (Source:\
      \ 00000000-00001824.00000002.225105.28470000.00000004.mdmp, 00000000-00001824.00000002.225105.2A470000.00000004.mdmp,\
      \ Indicator: \"select idx,count(*) from %q.sqlite_stat4 group by idx collate\
      \ nocase\"), \"CREATE TABLE x(_shape\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"create\
      \ table x(_shape\")\n \"UPDATE OR %s \"%w\".\"%w_vocab\" SET id=%lld, rank=%d,\
      \ langid=%d, word=%Q, k1=nullif(%Q,%Q), k2=%Q WHERE id=%lld\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"update\
      \ or %s \"%w\".\"%w_vocab\" set id=%lld, rank=%d, langid=%d, word=%q, k1=nullif(%q,%q)\n\
      \ k2=%q where id=%lld\"), \"DELETE FROM \"%w\".\"%w_vocab\"  WHERE id=%lld\"\
      \ (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp, 00000000-00001824.00000002.225105.2A470000.00000004.mdmp,\
      \ Indicator: \"delete from \"%w\".\"%w_vocab\"  where id=%lld\"), \"SELECT*FROM\"\
      %w\".%s ORDER BY rowid\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"select*from\"\
      %w\".%s order by rowid\"), \"SELECT*FROM\"%w\".%s WHERE %s ORDER BY rowid\"\
      \ (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp, 00000000-00001824.00000002.225105.2A470000.00000004.mdmp,\
      \ Indicator: \"select*from\"%w\".%s where %s order by rowid\"), \"UPDATE %Q.sqlite_master\
      \ SET rootpage=%d WHERE #%d AND rootpage=#%d\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"update\
      \ %q.sqlite_master set rootpage=%d where #%d and rootpage=#%d\"), \"UPDATE %Q.sqlite_master\
      \ SET type='%s'\n name=%Q\n tbl_name=%Q\n rootpage=#%d\n sql=%Q WHERE rowid=#%d\"\
      \ (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp, 00000000-00001824.00000002.225105.2A470000.00000004.mdmp,\
      \ Indicator: \"update %q.sqlite_master set type='%s'\n name=%q\n tbl_name=%q\n\
      \ rootpage=#%d\n sql=%q where rowid=#%d\"), \"UPDATE %Q.sqlite_master SET type='table'\n\
      \ name=%Q\n tbl_name=%Q\n rootpage=0\n sql=%Q WHERE rowid=#%d\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"update\
      \ %q.sqlite_master set type='table'\n name=%q\n tbl_name=%q\n rootpage=0\n sql=%q\
      \ where rowid=#%d\"), \"CREATE TABLE x(%.*s INT\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"create\
      \ table x(%.*s int\")\n \"SELECT %s FROM %s AS T\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"select\
      \ %s from %s as t\")\n \"DELETE FROM %Q.%s WHERE %s=%Q\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"delete\
      \ from %q.%s where %s=%q\")\n \"DELETE FROM %Q.sqlite_sequence WHERE name=%Q\"\
      \ (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp, 00000000-00001824.00000002.225105.2A470000.00000004.mdmp,\
      \ Indicator: \"delete from %q.sqlite_sequence where name=%q\")\n \"SELECT *\
      \ FROM %Q.%Q\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"select\
      \ * from %q.%q\")\n \"UPDATE \"%w\".sqlite_sequence set name = %Q WHERE name\
      \ = %Q\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"update\
      \ \"%w\".sqlite_sequence set name = %q where name = %q\")\n \"UPDATE \"%w\"\
      .sqlite_master SET sql = printf('%%.%ds, ',sql) || %Q || substr(sql,1+length(printf('%%.%ds',sql)))\
      \ WHERE type = 'table' AND name = %Q\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"update\
      \ \"%w\".sqlite_master set sql = printf('%%.%ds, ',sql) || %q || substr(sql,1+length(printf('%%.%ds',sql)))\
      \ where type = 'table' and name = %q\"), \"SELECT %s FROM %s T WHERE T.%Q <=\
      \ ? AND T.%Q >= ? ORDER BY T.%Q DESC\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"select\
      \ %s from %s t where t.%q <= ? and t.%q >= ? order by t.%q desc\"), \"SELECT\
      \ %s FROM %s T WHERE T.%Q >= ? AND T.%Q <= ? ORDER BY T.%Q ASC\" (Source: 00000000-00001824.00000002.225105.28470000.00000004.mdmp,\
      \ 00000000-00001824.00000002.225105.2A470000.00000004.mdmp, Indicator: \"select\
      \ %s from %s t where t.%q >= ? and t.%q <= ? order by t.%q asc\")"
  - EventData: Contains SQL queries
  - EventData: string-16
  - EventData: "Found string \"if (Test-Path $ProgramFilesX86) {\" (Indicator: \"\
      Test-Path\"; Source: \"00000000-00005484.00000001.223198.06900000.00000004.mdmp\"\
      )\n Found string \"if (Test-Path $ProgramFilesX86) {\" (Indicator: \"Test-Path\"\
      ; Source: \"00000000-00007828.00000001.222514.06400000.00000004.mdmp\")\n Found\
      \ string \"powershell_ise.exe\" (Indicator: \"powershell_ise.exe\"; Source:\
      \ \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\")\n Found string\
      \ \"Press Enter to continue...me of the email server. This can be used instead\
      \ of the HostName parameter in the Send-MailMessage cmd\" (Indicator: \"Send-MailMessage\"\
      ; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\")\n Found\
      \ string \"Join-Path\" (Indicator: \"Join-Path\"; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\"\
      )\n Found string \"Always resolve file paths using Resolve-Path -Relative.\"\
      \ (Indicator: \"Resolve-Path\"; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\"\
      )\n Found string \"Variable to contain the name of the email server. This can\
      \ be used instead of the HostName parameter in the Send-MailMessage cmdlet.ater\
      \ than $ConfirmPreference. If $ConfirmPreference is None, actions will only\
      \ be confirmed when Confirm is specified.\" (Indicator: \"Send-MailMessage\"\
      ; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\")\n Found\
      \ string \"Variable to contain the name of the email server. This can be used\
      \ instead of the HostName parameter in the Send-MailMessage cmdlet.\" (Indicator:\
      \ \"Send-MailMessage\"; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\"\
      )\n Found string \"Resolve-Path\" (Indicator: \"Resolve-Path\"; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\"\
      )\n Found string \"Write-Output\" (Indicator: \"Write-Output\"; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\"\
      )\n Found string \"Show-Command\" (Indicator: \"Show-Command\"; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\"\
      )\n Found string \"Trace-Command\" (Indicator: \"Trace-Command\"; Source: \"\
      00000000-00008028.00000000.221898.04840000.00000004.mdmp\")\n Found string \"\
      Pop-Location\" (Indicator: \"Pop-Location\"; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\"\
      )\n Found string \"Push-Location\" (Indicator: \"Push-Location\"; Source: \"\
      00000000-00008028.00000000.221898.04840000.00000004.mdmp\")\n Found string \"\
      Select-String\" (Indicator: \"Select-String\"; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\"\
      )\n Found string \"Enter-PSHostProcess\" (Indicator: \"Enter-PSHostProcess\"\
      ; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\")\n Found\
      \ string \"Exit-PSHostProcess\" (Indicator: \"Exit-PSHostProcess\"; Source:\
      \ \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\")\n Found string\
      \ \"Save-Help\" (Indicator: \"Save-Help\"; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\"\
      )\n Found string \"Test-ModuleManifest\" (Indicator: \"Test-ModuleManifest\"\
      ; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\")\n Found\
      \ string \"$pathsToProcess += Resolve-Path -LiteralPath $LiteralPath | Foreach-Object\
      \ ProviderPath\" (Indicator: \"Resolve-Path\"; Source: \"00000000-00008028.00000000.221898.07100000.00000004.mdmp\"\
      )\n Found string \"$pathsToProcess += Resolve-Path $Path | Foreach-Object ProviderPath\"\
      \ (Indicator: \"Resolve-Path\"; Source: \"00000000-00008028.00000000.221898.07100000.00000004.mdmp\"\
      )\n Found string \"if(Test-Path -LiteralPath $filePath -PathType Container)\"\
      \ (Indicator: \"Test-Path\"; Source: \"00000000-00008028.00000000.221898.07100000.00000004.mdmp\"\
      )\n Found string \"Write-Error -Message $errorMessage -Category ReadError -ErrorId\
      \ \"FileReadError\" -TargetObject $FilePath\" (Indicator: \"Write-Error\"; Source:\
      \ \"00000000-00008028.00000000.221898.07100000.00000004.mdmp\")\n Found string\
      \ \"Write-Error -ErrorRecord $errorRecord\" (Indicator: \"Write-Error\"; Source:\
      \ \"00000000-00008028.00000000.221898.07100000.00000004.mdmp\")"
  - EventData: Observed Powershell command strings
  - EventData: string-187
  - EventData: "Found reference to API \"FindResourceExW\" (Indicator: \"FindResource\"\
      ; Source: \"00000000-00008028.00000000.221898.01241000.00000002.mdmp\")\n Found\
      \ reference to API \"LoadResource\" (Indicator: \"LoadResource\"; Source: \"\
      00000000-00008028.00000000.221898.01241000.00000002.mdmp, 00000000-00008028.00000001.222737.6EAF5000.00000002.mdmp\"\
      )"
  - EventData: Contains ability to find and load resources of specific modules (API
      string)
  - EventData: string-550
  - EventData: "Found reference to API \"[Parameter(ParameterSetName='ShowWindow',\
      \ Mandatory=$true)]\" (Indicator: \"ShowWindow\"; Source: \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\"\
      )\n Found reference to API \"${ShowWindow})\" (Indicator: \"ShowWindow\"; Source:\
      \ \"00000000-00008028.00000000.221898.04840000.00000004.mdmp\")"
  - EventData: Contains ability to show a graphical window (API string)
  - EventData: string-208
  - EventData: "\"<Input Sample.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcryptprimitives.dll\"\
      \ at 76650000\n \"<Input Sample.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcrypt.dll\"\
      \ at 727B0000\n \"SearchUI.exe\" loaded module \"%WINDIR%\\SysWOW64\\bcryptprimitives.dll\"\
      \ at 76650000"
  - EventData: Loads the Bcrypt module DLL
  - EventData: module-9
  - EventData: 'Found string "Start-Process" (Indicator: "Start-Process"; Source:
      "00000000-00008028.00000000.221898.04840000.00000004.mdmp")'
  - EventData: Contains ability to start a process (Powershell command string)
  - EventData: string-250
  - EventData: "Process <Input Sample.exe created mutex with name  \"\\Sessions\\\
      1\\BaseNamedObjects\\SM0:5084:168:WilStaging_02\"\n Process <Input Sample.exe\
      \ created mutex with name  \"SM0:5084:168:WilStaging_02\"\n Process <Input Sample.exe\
      \ created mutex with name  \"\\BaseNamedObjects\\WEBR_NJ978QUPLHCD\"\n Process\
      \ SearchUI.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\\
      RstrMgr3887CAB8-533F-4C85-B0DC-3E5639F8D511\"\n Process SearchUI.exe created\
      \ mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0000\"\
      \n Process SearchUI.exe created mutex with name  \"RstrMgr-3887CAB8-533F-4C85-B0DC-3E5639F8D511-Session0000\"\
      \n Process SearchUI.exe created mutex with name  \"RstrMgr3887CAB8-533F-4C85-B0DC-3E5639F8D511\"\
      \n Process SearchUI.exe created mutex with name  \"\\Sessions\\1\\BaseNamedObjects\\\
      SM0:1824:168:WilStaging_02\""
  - EventData: Creates mutants
  - EventData: mutant-0
  - EventData: "\"<Input Sample.exe\" touched \"WBEM Scripting Locator\" (Path: \"\
      HKCU\\WOW6432NODE\\CLSID\\{76A64158-CB41-11D1-8B02-00600806D9B6}\")\n \"<Input\
      \ Sample.exe\" touched \"WBEM Locator\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\\
      {4590F811-1D3A-11D0-891F-00AA004B2E24}\\TREATAS\")\n \"<Input Sample.exe\" touched\
      \ \"PSDispatch\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{00020420-0000-0000-C000-000000000046}\\\
      TREATAS\")\n \"<Input Sample.exe\" touched \"WbemDefaultPathParser\" (Path:\
      \ \"HKCU\\WOW6432NODE\\CLSID\\{CF4CC405-E2C5-4DDD-B3CE-5E7582D8C9FA}\\TREATAS\"\
      )\n \"<Input Sample.exe\" touched \"Windows Management and Instrumentation\"\
      \ (Path: \"HKCU\\WOW6432NODE\\CLSID\\{8BC3F05E-D86B-11D0-A075-00C04FB68820}\\\
      TREATAS\")\n \"<Input Sample.exe\" touched \"PSFactoryBuffer\" (Path: \"HKCU\\\
      WOW6432NODE\\CLSID\\{7C857801-7381-11CF-884D-00AA004B2E24}\\TREATAS\")\n \"\
      <Input Sample.exe\" touched \"Microsoft WBEM Call Context\" (Path: \"HKCU\\\
      WOW6432NODE\\CLSID\\{674B6698-EE92-11D0-AD71-00C04FD8FDFF}\\TREATAS\")\n \"\
      <Input Sample.exe\" touched \"Microsoft WBEM (non)Standard Marshaling for IWbemServices\"\
      \ (Path: \"HKCU\\WOW6432NODE\\CLSID\\{D68AF00A-29CB-43FA-8504-CE99A996D9EA}\\\
      TREATAS\")\n \"<Input Sample.exe\" touched \"Microsoft WBEM (non)Standard Marshaling\
      \ for IEnumWbemClassObject\" (Path: \"HKCU\\WOW6432NODE\\CLSID\\{1B1CAD8C-2DAB-11D2-B604-00104B703EFD}\\\
      TREATAS\")\n \"<Input Sample.exe\" touched \"PSEnumVariant\" (Path: \"HKCU\\\
      WOW6432NODE\\CLSID\\{00020421-0000-0000-C000-000000000046}\\TREATAS\")\n \"\
      <Input Sample.exe\" touched \"TaskScheduler class\" (Path: \"HKCU\\WOW6432NODE\\\
      CLSID\\{0F87369F-A4E5-4CFC-BD3E-73E6154572DD}\\TREATAS\")"
  - EventData: Overview of unique CLSIDs touched in registry
  - EventData: registry-72
  selection_network:
  - DestinationHostname: 32.dll
  - DestinationHostname: 9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin
  - DestinationHostname: 9e52e19e61194a71703a542c1241e3c88093241dc5d02b1945f2b5c6b6c1e348.bin.exe
  - DestinationHostname: KERNEL32.DLL
  - DestinationHostname: SearchUI.exe
  - DestinationHostname: advapi32.dll
  - DestinationHostname: api-ms-win-core-synch-l1-2-0.dll
  - DestinationHostname: bcryptprimitives.dll
  - DestinationHostname: gdi32.dll
  - DestinationHostname: iphlpapi.dll
  - DestinationHostname: kernel32.dll
  - DestinationHostname: netapi32.dll
  - DestinationHostname: ntdll.dll
  - DestinationHostname: ole32.dll
  - DestinationHostname: oleaut32.dll
  - DestinationHostname: powershell.exe
  - DestinationHostname: powrprof.dll
  - DestinationHostname: rstrtmgr.dll
  - DestinationHostname: user32.dll
  - DestinationHostname: userenv.dll
  - DestinationHostname: winmm.dll
  - DestinationHostname: wtsapi32.dll
  - DestinationHostname: ywzu7870.default
  - DestinationIp: 104.21.19.248
  condition: selection_behavior or selection_network
