title: Malware_52.9 behavior detection (4caa21dc)
id: 4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203
status: experimental
description: Auto-generated Sigma rule for Malware_52.9
logsource:
  product: windows
  service: sysmon
detection:
  selection_behavior:
  - EventData: "Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"\
      ; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API \"CreateFileW\" (Indicator: \"CreateFile\"; Source:\
      \ \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")"
  - EventData: Contains ability to create/open files (API string)
  - EventData: string-315
  - EventData: "\"<Input Sample.exe\" loaded module \"%WINDIR%\\System32\\bcryptprimitives.dll\"\
      \ at 730A0000\n \"calc.exe\" loaded module \"%WINDIR%\\System32\\bcryptprimitives.dll\"\
      \ at 730A0000\n \"calc.exe\" loaded module \"%WINDIR%\\System32\\bcrypt.dll\"\
      \ at 728B0000"
  - EventData: Loads the Bcrypt module DLL
  - EventData: module-9
  - EventData: '"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin"
      has high imagebase  "0x140000000"'
  - EventData: PE file has a high image base
  - EventData: static-93
  - EventData: "\"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      \ file has an entrypoint instructions - \"sub\trsp, 0x28,call\t0x14002100c,add\t\
      rsp, 0x28,jmp\t0x140020ba4,int3\t,int3\t,int3\t,int3\t,int3\t,int3\t,int3\t\
      ,int3\t,int3\t,int3\t,int3\t,int3\t,int3\t,int3\t,int3\t,int3\t,int3\t,int3\t\
      ,int3\t,int3\t,nop\tword ptr [rax + rax],sub\trsp, 0x10,mov\tqword ptr [rsp],\
      \ r10,mov\tqword ptr [rsp + 8], r11,xor\tr11, r11,lea\tr10, [rsp + 0x18],sub\t\
      r10, rax,cmovb\tr10, r11,mov\tr11, qword ptr gs:[0x10],cmp\tr10, r11,jae\t0x140020d90,and\t\
      r10w, 0xf000,\""
  - EventData: PE file entrypoint instructions
  - EventData: static-96
  - EventData: LoadLibraryA@kernel32.dll at 13961-635-000000014000C1C9
  - EventData: Contains ability to dynamically load libraries
  - EventData: stream-108
  - EventData: "Found reference to API \"SetLastError\" (Indicator: \"SetLastError\"\
      ; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API \"GetLastError\" (Indicator: \"GetLastError\"; File:\
      \ \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n\
      \ Found reference to API \"GetLastError\" (Indicator: \"GetLastError\"; Source:\
      \ \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API \"SetLastError\" (Indicator: \"SetLastError\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )"
  - EventData: Contains ability to set/get the last-error code for a calling thread
      (API string)
  - EventData: string-319
  - EventData: "Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\ub_checks.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\ptr\\const_ptr.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"called `Result::unwrap()` on an `Err` value/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\alloc\\layout.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\alloc\\src\\vec\\mod.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\std\\src\\io\\error\\repr_bitpacked.rs\" (Indicator: \"/rustc/\"; File:\
      \ \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n\
      \ Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\ptr\\unique.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\ptr\\mod.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\iter\\adapters\\enumerate.rs\" (Indicator: \"/rustc/\";\
      \ File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n file/memory contains long string with (Indicator: \"/rustc/\"; File: \"\
      4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n Found\
      \ reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\library\\\
      alloc\\src\\raw_vec\\mod.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\ptr\\non_null.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\char\\methods.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\sync\\atomic.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"note: Some details are omitted, run with `RUST_BACKTRACE=full`\
      \ for a verbose backtrace.__rust_end_short_backtrace__rust_begin_short_backtraces\
      \      [... omitted  frame ...]\" (Indicator: \"rust_backtrace\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"RUST_BACKTRACEmainfailed to generate unique thread\
      \ ID: bitspace exhausted\" (Indicator: \"rust_backtrace\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"note: run with `RUST_BACKTRACE=1` environment variable\
      \ to display a backtrace\" (Indicator: \"rust_backtrace\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\str\\pattern.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\ops\\function.rs\" (Indicator: \"/rustc/\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference string \"rust_panic\" (Indicator: \"rust_panic\"; File:\
      \ \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n\
      \ Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\ub_checks.rs\" (Indicator: \"/rustc/\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\ptr\\const_ptr.rs\" (Indicator: \"/rustc/\"; Source: \"\
      00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ string \"called `Result::unwrap()` on an `Err` value/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\core\\src\\alloc\\layout.rs\" (Indicator: \"/rustc/\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\alloc\\src\\vec\\mod.rs\" (Indicator: \"/rustc/\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference string \"/rustc/ded5c06cf21d2b93bffd5d884aa6e96934ee4234\\\
      library\\std\\src\\io\\error\\repr_bitpacked.rs\" (Indicator: \"/rustc/\"; Source:\
      \ \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")"
  - EventData: Contains artifacts from Rust programming language
  - EventData: string-943
  - EventData: '"inject_demo.pdb"'
  - EventData: Contains PDB pathways
  - EventData: string-7
  - EventData: "\"<Input Sample.exe\" loaded module \"%WINDIR%\\SYSTEM32\\IMM32.DLL\"\
      \ at base 7ffc769a0000\n \"<Input Sample.exe\" loaded module \"API-MS-WIN-CORE-SYNCH-L1-2-0\"\
      \ at base 7ffc73220000\n \"<Input Sample.exe\" loaded module \"API-MS-WIN-CORE-FIBERS-L1-1-1\"\
      \ at base 7ffc73220000\n \"<Input Sample.exe\" loaded module \"API-MS-WIN-CORE-LOCALIZATION-L1-2-1\"\
      \ at base 7ffc73220000\n \"<Input Sample.exe\" loaded module \"KERNEL32\" at\
      \ base 7ffc744a0000\n \"<Input Sample.exe\" loaded module \"%WINDIR%\\TEMP\\\
      VXOLE64.DLL\" at base 7ffc53990000\n \"<Input Sample.exe\" loaded module \"\
      API-MS-WIN-APPMODEL-RUNTIME-L1-1-2\" at base 7ffc72df0000\n \"explorer.exe\"\
      \ loaded module \"PLOPTIN.DLL\" at base 7ffc60730000\n \"explorer.exe\" loaded\
      \ module \"SHELL32.DLL\" at base 7ffc746e0000\n \"explorer.exe\" loaded module\
      \ \"%WINDIR%\\TEMP\\VXSSL64.DLL\" at base 7ffc5e450000"
  - EventData: Loads modules at runtime
  - EventData: api-7
  - EventData: "\"<Input Sample.exe\" called \"LoadLibrary\" with a parameter api-ms-win-core-synch-l1-2-0\
      \ (UID: 00000000-00004272)\n \"<Input Sample.exe\" called \"LoadLibrary\" with\
      \ a parameter api-ms-win-core-fibers-l1-1-1 (UID: 00000000-00004272)\n \"<Input\
      \ Sample.exe\" called \"LoadLibrary\" with a parameter api-ms-win-core-localization-l1-2-1\
      \ (UID: 00000000-00004272)\n \"<Input Sample.exe\" called \"LoadLibrary\" with\
      \ a parameter kernel32 (UID: 00000000-00004272)"
  - EventData: Calls an API typically used to load libraries
  - EventData: api-175
  - EventData: "\"<Input Sample.exe\" loaded module \"%WINDIR%\\System32\\rpcrt4.dll\"\
      \ at 75B20000\n \"calc.exe\" loaded module \"%WINDIR%\\System32\\rpcrt4.dll\"\
      \ at 75B20000"
  - EventData: Loads the RPC (Remote Procedure Call) module DLL
  - EventData: module-10
  - EventData: 'Process "explorer.exe" (UID: 00000000-00005424) was launched with
      new environment variables: "USERDNSDOMAIN="DESKTOP-FVVF82A""'
  - EventData: Process launched with changed environment
  - EventData: target-67
  - EventData: 'Spawned process "calc.exe" (UID: 00000000-00007548)'
  - EventData: Spawns new processes that are not known child processes
  - EventData: target-103
  - EventData: Spawns new processes
  - EventData: target-25
  - EventData: "\"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      \ was detected as \"Microsoft Visual C/C++\"  and name: \"Compiler\"\n \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      \ was detected as \"Rust\"  and name: \"Compiler\"\n \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      \ was detected as \"Microsoft Linker\"  and name: \"Linker\""
  - EventData: Matched Compiler/Packer signature (DIE)
  - EventData: static-157
  - EventData: "\"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      \ has flags like  IMAGE_DLLCHARACTERISTICS_HIGH_ENTROPY_VA\n IMAGE_DLLCHARACTERISTICS_DYNAMIC_BASE\n\
      \ IMAGE_DLLCHARACTERISTICS_NX_COMPAT\n IMAGE_DLLCHARACTERISTICS_TERMINAL_SERVER_AWARE"
  - EventData: File contains dynamic base/NX flags
  - EventData: static-154
  - EventData: 'Found GetProcAddress() and LoadLibraryA() in an import section (Source:
      4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin)'
  - EventData: Contains ability to dynamically determine API calls
  - EventData: static-79
  - EventData: "WaitForSingleObject@kernel32.dll at 13961-284-000000014000F860\n WaitForSingleObjectEx@kernel32.dll\
      \ at 13961-635-000000014000C1C9"
  - EventData: Contains ability to delay the execution of current thread
  - EventData: stream-103
  - EventData: "Found reference to API (Indicator: \"RtlLookupFunctionEntry\"; File:\
      \ \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n\
      \ Found reference to API (Indicator: \"GetFullPathNameW\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetConsoleMode\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"RtlCaptureContext\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"HeapFree\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"FreeLibrary\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetCurrentProcess\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"ReleaseMutex\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"WideCharToMultiByte\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"WaitForSingleObjectEx\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"RtlVirtualUnwind\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"HeapAlloc\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetEnvironmentVariableW\"; File: \"\
      4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n Found\
      \ reference to API (Indicator: \"QueryPerformanceCounter\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetCurrentThread\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"WriteConsoleW\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetStdHandle\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetCurrentThreadId\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetSystemTimeAsFileTime\"; File: \"\
      4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n Found\
      \ reference to API (Indicator: \"Process32First\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"IsDebuggerPresent\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"CreateRemoteThread\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"SetThreadStackGuarantee\"; File: \"\
      4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n Found\
      \ reference to API (Indicator: \"AddVectoredExceptionHandler\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetProcAddress\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"lstrlenW\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"CloseHandle\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"Process32Next\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"FormatMessageW\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"SetLastError\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"CreateMutexA\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"LoadLibraryA\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"VirtualAllocEx\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetCurrentProcessId\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"WaitForSingleObject\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetProcessHeap\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetLastError\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"HeapReAlloc\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"WriteProcessMemory\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetConsoleOutputCP\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"LoadLibraryExA\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"SetFileInformationByHandle\"; File:\
      \ \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n\
      \ Found reference to API (Indicator: \"GetCurrentDirectoryW\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"CreateToolhelp32Snapshot\"; File: \"\
      4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n Found\
      \ reference to API (Indicator: \"MultiByteToWideChar\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetModuleHandleA\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"OpenProcess\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"CreateFileW\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"SetUnhandledExceptionFilter\"; File:\
      \ \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n\
      \ Found reference to API (Indicator: \"GetModuleHandleW\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"InitializeSListHead\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"NtWriteFile\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"RtlNtStatusToDosError\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"SysStringLen\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"SysFreeString\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"GetErrorInfo\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"SetThreadDescription\"; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API (Indicator: \"SetThreadDescription\"; Source: \"\
      00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"CloseHandle\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"OpenProcess\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CreateRemoteThread\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"VirtualAllocEx\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"IsDebuggerPresent\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"Process32Next\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"Process32First\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CreateToolhelp32Snapshot\"; Source:\
      \ \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"WriteProcessMemory\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"LoadLibraryExA\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetProcAddress\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"FreeLibrary\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetProcessHeap\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"HeapAlloc\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"HeapFree\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetLastError\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"FormatMessageW\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"WaitForSingleObject\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SysStringLen\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SysFreeString\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetErrorInfo\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"HeapReAlloc\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"lstrlenW\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetCurrentProcess\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"WideCharToMultiByte\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"WaitForSingleObjectEx\"; Source: \"\
      00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"LoadLibraryA\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetCurrentProcessId\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CreateMutexA\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"ReleaseMutex\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SetFileInformationByHandle\"; Source:\
      \ \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"RtlNtStatusToDosError\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"AddVectoredExceptionHandler\"; Source:\
      \ \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"SetThreadStackGuarantee\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetCurrentThread\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SetLastError\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetCurrentDirectoryW\"; Source: \"\
      00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"GetEnvironmentVariableW\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"CreateFileW\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetConsoleMode\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetFullPathNameW\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetCurrentThreadId\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetModuleHandleA\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetModuleHandleW\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"NtWriteFile\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"MultiByteToWideChar\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"WriteConsoleW\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetStdHandle\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetConsoleOutputCP\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"QueryPerformanceCounter\"; Source:\
      \ \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"RtlCaptureContext\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"RtlLookupFunctionEntry\"; Source: \"\
      00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"RtlVirtualUnwind\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"GetSystemTimeAsFileTime\"; Source:\
      \ \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API (Indicator: \"InitializeSListHead\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )\n Found reference to API (Indicator: \"SetUnhandledExceptionFilter\"; Source:\
      \ \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")"
  - EventData: Contains ability to execute Windows APIs
  - EventData: string-101
  - EventData: "Found reference to API \"GetProcessHeap\" (Indicator: \"GetProcessHeap\"\
      ; File: \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\"\
      )\n Found reference to API \"OpenProcess\" (Indicator: \"OpenProcess\"; File:\
      \ \"4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin\")\n\
      \ Found reference to API \"OpenProcess\" (Indicator: \"OpenProcess\"; Source:\
      \ \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\")\n Found reference\
      \ to API \"GetProcessHeap\" (Indicator: \"GetProcessHeap\"; Source: \"00000000-00004272.00000000.235124.8C503000.00000002.mdmp\"\
      )"
  - EventData: Contains ability to retrieve/open a process (API string)
  - EventData: string-272
  - EventData: 'Observed system executable string:"%WINDIR%\System32\calc.exe" [Source:
      00000000-00005424-00000BC0-2602140449]'
  selection_network:
  - DestinationHostname: 4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin
  - DestinationHostname: 4caa21dc95e2c71e1536ee540d828b3772f2e90061e8c5553bc8f14ebce1d203.bin.exe
  - DestinationHostname: api-ms-win-core-synch-l1-2-0.dll
  - DestinationHostname: calc.exe
  - DestinationHostname: conhost.exe
  - DestinationHostname: explorer.exe
  - DestinationHostname: kernel32.dll
  - DestinationHostname: ntdll.dll
  condition: selection_behavior or selection_network
